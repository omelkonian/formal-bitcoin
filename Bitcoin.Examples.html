<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Bitcoin.Examples</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitcoin/tree/master/Bitcoin/Examples.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Examples 5,6,7 from the paper.</a>
<a id="108" class="Comment">------------------------------------------------------------------------</a>
<a id="181" class="Symbol">{-#</a> <a id="185" class="Keyword">OPTIONS</a> <a id="193" class="Pragma">--rewriting</a> <a id="205" class="Symbol">#-}</a>
<a id="209" class="Keyword">module</a> <a id="216" href="Bitcoin.Examples.html" class="Module">Bitcoin.Examples</a> <a id="233" class="Keyword">where</a>

<a id="240" class="Keyword">open</a> <a id="245" class="Keyword">import</a> <a id="252" href="Agda.Builtin.Equality.Rewrite.html" class="Module">Agda.Builtin.Equality.Rewrite</a>

<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="307" class="Symbol">;</a> <a id="309" class="Keyword">open</a> <a id="314" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="324" class="Keyword">open</a> <a id="329" href="Prelude.Init.html#3301" class="Module">Nat</a> <a id="333" class="Keyword">using</a> <a id="339" class="Symbol">(</a><a id="340" href="Data.Nat.Properties.html#4574" class="Function">≤-refl</a><a id="346" class="Symbol">;</a> <a id="348" href="Data.Nat.Properties.html#17089" class="Function">m≤m+n</a><a id="353" class="Symbol">)</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="409" class="Keyword">open</a> <a id="414" class="Keyword">import</a> <a id="421" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="434" class="Keyword">open</a> <a id="439" class="Keyword">import</a> <a id="446" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>
<a id="461" class="Keyword">open</a> <a id="466" class="Keyword">import</a> <a id="473" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>

<a id="521" class="Keyword">open</a> <a id="526" class="Keyword">import</a> <a id="533" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a>
<a id="548" class="Keyword">open</a> <a id="553" class="Keyword">import</a> <a id="560" href="Bitcoin.BasicTypes.html" class="Module">Bitcoin.BasicTypes</a>
<a id="579" class="Keyword">open</a> <a id="584" class="Keyword">import</a> <a id="591" href="Bitcoin.Script.html" class="Module">Bitcoin.Script</a>
<a id="606" class="Keyword">open</a> <a id="611" class="Keyword">import</a> <a id="618" href="Bitcoin.Tx.html" class="Module">Bitcoin.Tx</a>
<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="Bitcoin.Consistency.html" class="Module">Bitcoin.Consistency</a>

<a id="662" class="Keyword">postulate</a>
  <a id="k₁"></a><a id="674" href="Bitcoin.Examples.html#674" class="Postulate">k₁</a> <a id="k₂"></a><a id="677" href="Bitcoin.Examples.html#677" class="Postulate">k₂</a> <a id="k₃"></a><a id="680" href="Bitcoin.Examples.html#680" class="Postulate">k₃</a> <a id="683" class="Symbol">:</a> <a id="685" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>
  <a id="t₂"></a><a id="695" href="Bitcoin.Examples.html#695" class="Postulate">t₂</a> <a id="t₃"></a><a id="698" href="Bitcoin.Examples.html#698" class="Postulate">t₃</a> <a id="701" class="Symbol">:</a> <a id="703" href="Bitcoin.BasicTypes.html#233" class="Function">Time</a>

<a id="T₁"></a><a id="709" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="712" class="Symbol">:</a> <a id="714" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="717" class="Number">0</a> <a id="719" class="Number">3</a>
<a id="721" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="724" class="Symbol">=</a> <a id="726" class="Keyword">record</a>
  <a id="735" class="Symbol">{</a> <a id="737" href="Bitcoin.Tx.Base.html#1152" class="Field">inputs</a>  <a id="745" class="Symbol">=</a> <a id="747" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
  <a id="752" class="Symbol">;</a> <a id="754" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a>     <a id="762" class="Symbol">=</a> <a id="764" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
  <a id="769" class="Symbol">;</a> <a id="771" href="Bitcoin.Tx.Base.html#1248" class="Field">relLock</a> <a id="779" class="Symbol">=</a> <a id="781" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
  <a id="786" class="Symbol">;</a> <a id="788" href="Bitcoin.Tx.Base.html#1302" class="Field">outputs</a> <a id="796" class="Symbol">=</a> <a id="798" class="Symbol">(</a><a id="799" class="Number">1</a> <a id="801" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="803" class="Number">3</a> <a id="805" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="815" href="Bitcoin.Script.Base.html#1840" class="InductiveConstructor Operator">ƛ</a> <a id="817" href="Bitcoin.Script.Base.html#1125" class="InductiveConstructor">versig</a> <a id="824" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="826" href="Bitcoin.Examples.html#674" class="Postulate">k₁</a> <a id="829" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="831" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="833" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="836" href="Data.List.Base.html#5034" class="Function Operator">]</a><a id="837" class="Symbol">)</a>
            <a id="851" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="853" class="Symbol">(</a><a id="854" class="Number">1</a> <a id="856" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="858" class="Number">5</a> <a id="860" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="870" href="Bitcoin.Script.Base.html#1840" class="InductiveConstructor Operator">ƛ</a> <a id="872" href="Bitcoin.Script.Base.html#1125" class="InductiveConstructor">versig</a> <a id="879" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="881" href="Bitcoin.Examples.html#677" class="Postulate">k₂</a> <a id="884" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="886" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="888" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="891" href="Data.List.Base.html#5034" class="Function Operator">]</a><a id="892" class="Symbol">)</a>
            <a id="906" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="908" class="Symbol">(</a><a id="909" class="Number">1</a> <a id="911" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="913" class="Number">7</a> <a id="915" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="925" href="Bitcoin.Script.Base.html#1840" class="InductiveConstructor Operator">ƛ</a> <a id="927" href="Bitcoin.Script.Base.html#1125" class="InductiveConstructor">versig</a> <a id="934" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="936" href="Bitcoin.Examples.html#680" class="Postulate">k₃</a> <a id="939" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="941" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="943" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="946" href="Data.List.Base.html#5034" class="Function Operator">]</a><a id="947" class="Symbol">)</a>
            <a id="961" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="963" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
  <a id="968" class="Symbol">;</a> <a id="970" href="Bitcoin.Tx.Base.html#1344" class="Field">absLock</a> <a id="978" class="Symbol">=</a> <a id="980" class="Number">0</a> <a id="982" class="Symbol">}</a>

<a id="T₂"></a><a id="985" href="Bitcoin.Examples.html#985" class="Function">T₂</a> <a id="988" class="Symbol">:</a> <a id="990" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="993" class="Number">2</a> <a id="995" class="Number">1</a>
<a id="997" href="Bitcoin.Examples.html#985" class="Function">T₂</a> <a id="1000" class="Symbol">=</a> <a id="1002" href="Bitcoin.Tx.Crypto.html#1224" class="Function">sig⋆</a> <a id="1007" class="Symbol">(</a><a id="1008" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1010" href="Bitcoin.Examples.html#677" class="Postulate">k₂</a> <a id="1013" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1015" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="1017" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1019" href="Bitcoin.Examples.html#680" class="Postulate">k₃</a> <a id="1022" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1024" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="1026" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a><a id="1028" class="Symbol">)</a> <a id="1030" class="Keyword">record</a>
  <a id="1039" class="Symbol">{</a> <a id="1041" href="Bitcoin.Tx.Base.html#1152" class="Field">inputs</a>  <a id="1049" class="Symbol">=</a> <a id="1051" class="Symbol">(</a><a id="1052" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1055" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1056" class="Symbol">)</a> <a id="1058" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1061" class="Number">1</a>
            <a id="1075" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="1077" class="Symbol">(</a><a id="1078" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1081" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1082" class="Symbol">)</a> <a id="1084" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1087" class="Number">2</a>
            <a id="1101" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="1103" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
  <a id="1108" class="Symbol">;</a> <a id="1110" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a>     <a id="1118" class="Symbol">=</a> <a id="1120" href="Bitcoin.Tx.Crypto.html#734" class="Function">wit⊥</a>
  <a id="1127" class="Symbol">;</a> <a id="1129" href="Bitcoin.Tx.Base.html#1248" class="Field">relLock</a> <a id="1137" class="Symbol">=</a> <a id="1139" class="Number">0</a>
            <a id="1153" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="1155" class="Number">0</a>
            <a id="1169" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="1171" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
  <a id="1176" class="Symbol">;</a> <a id="1178" href="Bitcoin.Tx.Base.html#1302" class="Field">outputs</a> <a id="1186" class="Symbol">=</a> <a id="1188" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="1192" class="Number">1</a> <a id="1194" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1196" class="Number">10</a> <a id="1199" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="1209" href="Bitcoin.Script.Base.html#1840" class="InductiveConstructor Operator">ƛ</a> <a id="1211" href="Bitcoin.Script.Base.html#1125" class="InductiveConstructor">versig</a> <a id="1218" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1220" href="Bitcoin.Examples.html#677" class="Postulate">k₂</a> <a id="1223" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1225" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1227" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="1230" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1232" href="Data.Vec.Base.html#5759" class="Function Operator">]</a>
  <a id="1236" class="Symbol">;</a> <a id="1238" href="Bitcoin.Tx.Base.html#1344" class="Field">absLock</a> <a id="1246" class="Symbol">=</a> <a id="1248" href="Bitcoin.Examples.html#695" class="Postulate">t₂</a> <a id="1251" class="Symbol">}</a>

<a id="T₃"></a><a id="1254" href="Bitcoin.Examples.html#1254" class="Function">T₃</a> <a id="1257" class="Symbol">:</a> <a id="1259" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1262" class="Number">1</a> <a id="1264" class="Number">1</a>
<a id="1266" href="Bitcoin.Examples.html#1254" class="Function">T₃</a> <a id="1269" class="Symbol">=</a> <a id="1271" href="Bitcoin.Tx.Crypto.html#1224" class="Function">sig⋆</a> <a id="1276" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="1280" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1282" href="Bitcoin.Examples.html#677" class="Postulate">k₂</a> <a id="1285" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1287" href="Data.Vec.Base.html#5759" class="Function Operator">]</a> <a id="1289" class="Keyword">record</a>
  <a id="1298" class="Symbol">{</a> <a id="1300" href="Bitcoin.Tx.Base.html#1152" class="Field">inputs</a>  <a id="1308" class="Symbol">=</a> <a id="1310" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="1314" class="Symbol">(</a><a id="1315" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1318" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1319" class="Symbol">)</a> <a id="1321" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1324" class="Number">1</a> <a id="1326" href="Data.Vec.Base.html#5759" class="Function Operator">]</a>
  <a id="1330" class="Symbol">;</a> <a id="1332" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a>     <a id="1340" class="Symbol">=</a> <a id="1342" href="Bitcoin.Tx.Crypto.html#734" class="Function">wit⊥</a>
  <a id="1349" class="Symbol">;</a> <a id="1351" href="Bitcoin.Tx.Base.html#1248" class="Field">relLock</a> <a id="1359" class="Symbol">=</a> <a id="1361" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="1365" class="Number">0</a> <a id="1367" href="Data.Vec.Base.html#5759" class="Function Operator">]</a>
  <a id="1371" class="Symbol">;</a> <a id="1373" href="Bitcoin.Tx.Base.html#1302" class="Field">outputs</a> <a id="1381" class="Symbol">=</a> <a id="1383" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="1387" class="Number">1</a> <a id="1389" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1391" class="Number">5</a> <a id="1393" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="1403" href="Bitcoin.Script.Base.html#1840" class="InductiveConstructor Operator">ƛ</a> <a id="1405" href="Bitcoin.Script.Base.html#1125" class="InductiveConstructor">versig</a> <a id="1412" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1414" href="Bitcoin.Examples.html#677" class="Postulate">k₂</a> <a id="1417" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1419" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1421" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="1424" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1426" href="Data.Vec.Base.html#5759" class="Function Operator">]</a>
  <a id="1430" class="Symbol">;</a> <a id="1432" href="Bitcoin.Tx.Base.html#1344" class="Field">absLock</a> <a id="1440" class="Symbol">=</a> <a id="1442" href="Bitcoin.Examples.html#698" class="Postulate">t₃</a> <a id="1445" class="Symbol">}</a>

<a id="B"></a><a id="1448" href="Bitcoin.Examples.html#1448" class="Function">B</a> <a id="1450" class="Symbol">:</a> <a id="1452" href="Bitcoin.Consistency.html#650" class="Function">Blockchain</a>
<a id="1463" href="Bitcoin.Examples.html#1448" class="Function">B</a> <a id="1465" class="Symbol">=</a> <a id="1467" class="Symbol">(</a><a id="1468" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1471" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1474" href="Bitcoin.Examples.html#985" class="Function">T₂</a><a id="1476" class="Symbol">)</a> <a id="1478" href="Bitcoin.Tx.Base.html#2667" class="InductiveConstructor Operator">at</a> <a id="1481" href="Bitcoin.Examples.html#695" class="Postulate">t₂</a> <a id="1484" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1486" class="Symbol">(</a><a id="1487" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1490" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1493" href="Bitcoin.Examples.html#709" class="Function">T₁</a><a id="1495" class="Symbol">)</a> <a id="1497" href="Bitcoin.Tx.Base.html#2667" class="InductiveConstructor Operator">at</a> <a id="1500" class="Number">0</a> <a id="1502" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1504" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

<a id="1508" class="Keyword">postulate</a>
  <a id="eq1"></a><a id="1520" href="Bitcoin.Examples.html#1520" class="Postulate">eq1</a> <a id="1524" class="Symbol">:</a> <a id="1526" class="Symbol">(</a><a id="1527" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1530" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1531" class="Symbol">)</a> <a id="1533" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1535" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1537" class="Number">1</a>
  <a id="eq2"></a><a id="1541" href="Bitcoin.Examples.html#1541" class="Postulate">eq2</a> <a id="1545" class="Symbol">:</a> <a id="1547" class="Symbol">(</a><a id="1548" href="Bitcoin.Examples.html#985" class="Function">T₂</a> <a id="1551" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1552" class="Symbol">)</a> <a id="1554" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1556" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1558" class="Number">2</a>
  <a id="eq3"></a><a id="1562" href="Bitcoin.Examples.html#1562" class="Postulate">eq3</a> <a id="1566" class="Symbol">:</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Bitcoin.Examples.html#1254" class="Function">T₃</a> <a id="1572" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1573" class="Symbol">)</a> <a id="1575" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1577" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1579" class="Number">3</a>
<a id="1581" class="Symbol">{-#</a> <a id="1585" class="Keyword">REWRITE</a> <a id="1593" href="Bitcoin.Examples.html#1520" class="Postulate">eq1</a> <a id="1597" class="Symbol">#-}</a>
<a id="1601" class="Symbol">{-#</a> <a id="1605" class="Keyword">REWRITE</a> <a id="1613" href="Bitcoin.Examples.html#1541" class="Postulate">eq2</a> <a id="1617" class="Symbol">#-}</a>
<a id="1621" class="Symbol">{-#</a> <a id="1625" class="Keyword">REWRITE</a> <a id="1633" href="Bitcoin.Examples.html#1562" class="Postulate">eq3</a> <a id="1637" class="Symbol">#-}</a>

<a id="_≈?ˢ_"></a><a id="1642" href="Bitcoin.Examples.html#1642" class="Function Operator">_≈?ˢ_</a> <a id="1648" class="Symbol">:</a> <a id="1650" class="Symbol">∀</a> <a id="1652" class="Symbol">(</a><a id="1653" href="Bitcoin.Examples.html#1653" class="Bound">x</a> <a id="1655" href="Bitcoin.Examples.html#1655" class="Bound">y</a> <a id="1657" class="Symbol">:</a> <a id="1659" href="Prelude.Sets.AsUniqueLists.Core.html#1017" class="Record">Set⟨</a> <a id="1664" href="Bitcoin.Tx.Base.html#359" class="Record">TxInput</a> <a id="1672" href="Prelude.Sets.AsUniqueLists.Core.html#1017" class="Record">⟩</a><a id="1673" class="Symbol">)</a> <a id="1675" class="Symbol">→</a> <a id="1677" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="1681" class="Symbol">(</a><a id="1682" href="Bitcoin.Examples.html#1653" class="Bound">x</a> <a id="1684" href="Prelude.Setoid.Core.html#191" class="Field Operator">≈</a> <a id="1686" href="Bitcoin.Examples.html#1655" class="Bound">y</a><a id="1687" class="Symbol">)</a>
<a id="1689" href="Bitcoin.Examples.html#1689" class="Bound">x</a> <a id="1691" href="Bitcoin.Examples.html#1642" class="Function Operator">≈?ˢ</a> <a id="1695" href="Bitcoin.Examples.html#1695" class="Bound">y</a> <a id="1697" class="Symbol">=</a> <a id="1699" class="Symbol">(</a><a id="1700" href="Bitcoin.Examples.html#1689" class="Bound">x</a> <a id="1702" href="Prelude.Sets.AsUniqueLists.Core.html#5440" class="Function Operator">⊆?ˢ</a> <a id="1706" href="Bitcoin.Examples.html#1695" class="Bound">y</a><a id="1707" class="Symbol">)</a> <a id="1709" href="Relation.Nullary.Product.html#930" class="Function Operator">×-dec</a> <a id="1715" class="Symbol">(</a><a id="1716" href="Bitcoin.Examples.html#1695" class="Bound">y</a> <a id="1718" href="Prelude.Sets.AsUniqueLists.Core.html#5440" class="Function Operator">⊆?ˢ</a> <a id="1722" href="Bitcoin.Examples.html#1689" class="Bound">x</a><a id="1723" class="Symbol">)</a>

<a id="b"></a><a id="1726" href="Bitcoin.Examples.html#1726" class="Function">b</a> <a id="1728" class="Symbol">=</a> <a id="1730" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1735" href="Bitcoin.Tx.Base.html#359" class="Record">TxInput</a> <a id="1743" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="1745" class="Symbol">(</a><a id="1746" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1749" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1750" class="Symbol">)</a> <a id="1752" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1755" class="Number">0</a> <a id="1757" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1759" class="Symbol">(</a><a id="1760" href="Bitcoin.Examples.html#985" class="Function">T₂</a> <a id="1763" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1764" class="Symbol">)</a> <a id="1766" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1769" class="Number">0</a> <a id="1771" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1773" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

<a id="1777" href="Bitcoin.Examples.html#1777" class="Function">_</a> <a id="1779" class="Symbol">:</a> <a id="1781" href="Bitcoin.Consistency.html#1368" class="Function">UTXO</a> <a id="1786" href="Bitcoin.Examples.html#1448" class="Function">B</a> <a id="1788" href="Prelude.Setoid.Core.html#191" class="Field Operator">≈</a> <a id="1790" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="1799" href="Bitcoin.Examples.html#1726" class="Function">b</a>
<a id="1801" class="Symbol">_</a> <a id="1803" class="Symbol">=</a> <a id="1805" href="Relation.Nullary.Decidable.Core.html#1493" class="Function">toWitness</a> <a id="1815" class="Symbol">{</a><a id="1816" class="Argument">Q</a> <a id="1818" class="Symbol">=</a> <a id="1820" href="Bitcoin.Consistency.html#1368" class="Function">UTXO</a> <a id="1825" href="Bitcoin.Examples.html#1448" class="Function">B</a> <a id="1827" href="Bitcoin.Examples.html#1642" class="Function Operator">≈?ˢ</a> <a id="1831" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="1840" href="Bitcoin.Examples.html#1726" class="Function">b</a><a id="1841" class="Symbol">}</a> <a id="1843" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a>

<a id="B₀"></a><a id="1847" href="Bitcoin.Examples.html#1847" class="Function">B₀</a> <a id="1850" class="Symbol">:</a> <a id="1852" href="Bitcoin.Consistency.html#650" class="Function">Blockchain</a>
<a id="1863" href="Bitcoin.Examples.html#1847" class="Function">B₀</a> <a id="1866" class="Symbol">=</a> <a id="1868" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1870" class="Symbol">(</a><a id="1871" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1874" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1877" href="Bitcoin.Examples.html#709" class="Function">T₁</a><a id="1879" class="Symbol">)</a> <a id="1881" href="Bitcoin.Tx.Base.html#2667" class="InductiveConstructor Operator">at</a> <a id="1884" class="Number">0</a> <a id="1886" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="b₀"></a><a id="1889" href="Bitcoin.Examples.html#1889" class="Function">b₀</a> <a id="1892" class="Symbol">=</a> <a id="1894" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1899" href="Bitcoin.Tx.Base.html#359" class="Record">TxInput</a> <a id="1907" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="1909" class="Symbol">(</a><a id="1910" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1913" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1914" class="Symbol">)</a> <a id="1916" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1919" class="Number">0</a> <a id="1921" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1923" class="Symbol">(</a><a id="1924" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1927" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1928" class="Symbol">)</a> <a id="1930" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1933" class="Number">1</a> <a id="1935" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1937" class="Symbol">(</a><a id="1938" href="Bitcoin.Examples.html#709" class="Function">T₁</a> <a id="1941" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="1942" class="Symbol">)</a> <a id="1944" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="1947" class="Number">2</a> <a id="1949" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1951" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

<a id="1955" href="Bitcoin.Examples.html#1955" class="Function">_</a> <a id="1957" class="Symbol">:</a> <a id="1959" href="Bitcoin.Consistency.html#1368" class="Function">UTXO</a> <a id="1964" href="Bitcoin.Examples.html#1847" class="Function">B₀</a> <a id="1967" href="Prelude.Setoid.Core.html#191" class="Field Operator">≈</a> <a id="1969" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="1978" href="Bitcoin.Examples.html#1889" class="Function">b₀</a>
<a id="1981" class="Symbol">_</a> <a id="1983" class="Symbol">=</a> <a id="1985" href="Relation.Nullary.Decidable.Core.html#1493" class="Function">toWitness</a> <a id="1995" class="Symbol">{</a><a id="1996" class="Argument">Q</a> <a id="1998" class="Symbol">=</a> <a id="2000" href="Bitcoin.Consistency.html#1368" class="Function">UTXO</a> <a id="2005" href="Bitcoin.Examples.html#1847" class="Function">B₀</a> <a id="2008" href="Bitcoin.Examples.html#1642" class="Function Operator">≈?ˢ</a> <a id="2012" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="2021" href="Bitcoin.Examples.html#1889" class="Function">b₀</a><a id="2023" class="Symbol">}</a> <a id="2025" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a>

<a id="2029" href="Bitcoin.Examples.html#2029" class="Function">_</a> <a id="2031" class="Symbol">:</a> <a id="2033" href="Bitcoin.Examples.html#1847" class="Function">B₀</a> <a id="2036" href="Bitcoin.Consistency.html#1636" class="Record Operator">▷</a> <a id="2038" href="Bitcoin.Examples.html#985" class="Function">T₂</a> <a id="2041" href="Bitcoin.Consistency.html#1636" class="Record Operator">,</a> <a id="2043" href="Bitcoin.Examples.html#695" class="Postulate">t₂</a>
<a id="2046" class="Symbol">_</a> <a id="2048" class="Symbol">=</a> <a id="2050" class="Keyword">record</a>
  <a id="2059" class="Symbol">{</a> <a id="2061" href="Bitcoin.Consistency.html#1746" class="Field">inputsUnique</a> <a id="2074" class="Symbol">=</a> <a id="2076" href="Prelude.Decidable.Core.html#181" class="Function">auto</a>
  <a id="2083" class="Symbol">;</a> <a id="2085" href="Bitcoin.Consistency.html#1800" class="Field">singleMatch</a> <a id="2097" class="Symbol">=</a> <a id="2099" class="Symbol">λ</a> <a id="2101" class="Keyword">where</a>
      <a id="2113" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="2116" class="Symbol">→</a> <a id="2118" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="2121" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
      <a id="2132" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a> <a id="2135" class="Symbol">→</a> <a id="2137" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="2140" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="2147" class="Symbol">;</a> <a id="2149" href="Bitcoin.Consistency.html#1930" class="Field">noOutOfBounds</a> <a id="2163" class="Symbol">=</a> <a id="2165" class="Symbol">λ</a> <a id="2167" class="Keyword">where</a>
      <a id="2179" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="2182" class="Symbol">→</a> <a id="2184" href="Data.Nat.Properties.html#17089" class="Function">m≤m+n</a> <a id="2190" class="Symbol">_</a> <a id="2192" class="Number">1</a>
      <a id="2200" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a> <a id="2203" class="Symbol">→</a> <a id="2205" href="Data.Nat.Properties.html#4574" class="Function">≤-refl</a>
  <a id="2214" class="Symbol">;</a> <a id="2216" href="Bitcoin.Consistency.html#2469" class="Field">inputs∈UTXO</a> <a id="2228" class="Symbol">=</a> <a id="2230" class="Symbol">λ</a> <a id="2232" class="Keyword">where</a>
      <a id="2244" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="2247" class="Symbol">→</a> <a id="2249" href="Prelude.Decidable.Core.html#181" class="Function">auto</a>
      <a id="2260" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a> <a id="2263" class="Symbol">→</a> <a id="2265" href="Prelude.Decidable.Core.html#181" class="Function">auto</a>
  <a id="2272" class="Symbol">;</a> <a id="2274" href="Bitcoin.Consistency.html#2541" class="Field">inputsRedeemable</a> <a id="2291" class="Symbol">=</a> <a id="2293" class="Symbol">λ</a> <a id="2295" class="Keyword">where</a>
      <a id="2307" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="2310" class="Symbol">→</a> <a id="2312" class="Keyword">record</a>
        <a id="2327" class="Symbol">{</a> <a id="2329" href="Bitcoin.Tx.Semantics.html#859" class="Field">input~output</a> <a id="2342" class="Symbol">=</a> <a id="2344" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
        <a id="2357" class="Symbol">;</a> <a id="2359" href="Bitcoin.Tx.Semantics.html#905" class="Field">scriptValidates</a> <a id="2375" class="Symbol">=</a> <a id="2377" href="Bitcoin.Tx.Crypto.html#1597" class="Function">ver⋆sig≡</a> <a id="2386" href="Bitcoin.Examples.html#985" class="Function">T₂</a> <a id="2389" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
        <a id="2400" class="Symbol">;</a> <a id="2402" href="Bitcoin.Tx.Semantics.html#965" class="Field">value≡</a> <a id="2409" class="Symbol">=</a> <a id="2411" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
        <a id="2424" class="Symbol">;</a> <a id="2426" href="Bitcoin.Tx.Semantics.html#1006" class="Field">satisfiesAbsLock</a> <a id="2443" class="Symbol">=</a> <a id="2445" href="Data.Nat.Properties.html#4574" class="Function">≤-refl</a>
        <a id="2460" class="Symbol">;</a> <a id="2462" href="Bitcoin.Tx.Semantics.html#1054" class="Field">satisfiesRelLock</a> <a id="2479" class="Symbol">=</a> <a id="2481" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a> <a id="2485" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2487" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a>
        <a id="2499" class="Symbol">}</a>
      <a id="2507" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a> <a id="2510" class="Symbol">→</a> <a id="2512" class="Keyword">record</a>
        <a id="2527" class="Symbol">{</a> <a id="2529" href="Bitcoin.Tx.Semantics.html#859" class="Field">input~output</a> <a id="2542" class="Symbol">=</a> <a id="2544" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
        <a id="2557" class="Symbol">;</a> <a id="2559" href="Bitcoin.Tx.Semantics.html#905" class="Field">scriptValidates</a> <a id="2575" class="Symbol">=</a> <a id="2577" href="Bitcoin.Tx.Crypto.html#1597" class="Function">ver⋆sig≡</a> <a id="2586" href="Bitcoin.Examples.html#985" class="Function">T₂</a> <a id="2589" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a>
        <a id="2600" class="Symbol">;</a> <a id="2602" href="Bitcoin.Tx.Semantics.html#965" class="Field">value≡</a> <a id="2609" class="Symbol">=</a> <a id="2611" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
        <a id="2624" class="Symbol">;</a> <a id="2626" href="Bitcoin.Tx.Semantics.html#1006" class="Field">satisfiesAbsLock</a> <a id="2643" class="Symbol">=</a> <a id="2645" href="Data.Nat.Properties.html#4574" class="Function">≤-refl</a>
        <a id="2660" class="Symbol">;</a> <a id="2662" href="Bitcoin.Tx.Semantics.html#1054" class="Field">satisfiesRelLock</a> <a id="2679" class="Symbol">=</a> <a id="2681" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a> <a id="2685" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2687" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a>
        <a id="2699" class="Symbol">}</a>
  <a id="2703" class="Symbol">;</a> <a id="2705" href="Bitcoin.Consistency.html#2666" class="Field">valuesPreserved</a> <a id="2721" class="Symbol">=</a> <a id="2723" href="Data.Nat.Properties.html#17089" class="Function">m≤m+n</a> <a id="2729" class="Symbol">_</a> <a id="2731" class="Number">2</a>
  <a id="2735" class="Symbol">;</a> <a id="2737" href="Bitcoin.Consistency.html#2867" class="Field">laterTime</a> <a id="2747" class="Symbol">=</a> <a id="2749" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a>
  <a id="2755" class="Symbol">}</a>

<a id="2758" href="Bitcoin.Examples.html#2758" class="Function">_</a> <a id="2760" class="Symbol">:</a> <a id="2762" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="2764" class="Symbol">(</a><a id="2765" href="Bitcoin.Examples.html#1448" class="Function">B</a> <a id="2767" href="Bitcoin.Consistency.html#1636" class="Record Operator">▷</a> <a id="2769" href="Bitcoin.Examples.html#1254" class="Function">T₃</a> <a id="2772" href="Bitcoin.Consistency.html#1636" class="Record Operator">,</a> <a id="2774" href="Bitcoin.Examples.html#698" class="Postulate">t₃</a><a id="2776" class="Symbol">)</a>
<a id="2778" class="Symbol">_</a> <a id="2780" class="Symbol">=</a> <a id="2782" class="Symbol">λ</a> <a id="2784" class="Keyword">where</a> <a id="2790" class="Keyword">record</a> <a id="2797" class="Symbol">{</a><a id="2798" href="Bitcoin.Consistency.html#2469" class="Field">inputs∈UTXO</a> <a id="2810" class="Symbol">=</a> <a id="2812" href="Bitcoin.Examples.html#2812" class="Bound">p</a><a id="2813" class="Symbol">}</a> <a id="2815" class="Symbol">→</a> <a id="2817" href="Prelude.Decidable.Core.html#347" class="Function">contradict</a> <a id="2828" class="Symbol">(</a><a id="2829" href="Bitcoin.Examples.html#2812" class="Bound">p</a> <a id="2831" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2833" class="Symbol">)</a>
</pre></body></html>