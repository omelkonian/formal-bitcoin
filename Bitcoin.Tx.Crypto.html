<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Bitcoin.Tx.Crypto</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitcoin/tree/master/Bitcoin/Tx/Crypto.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Hashing/signing transactions.</a>
<a id="107" class="Comment">------------------------------------------------------------------------</a>
<a id="180" class="Keyword">module</a> <a id="187" href="Bitcoin.Tx.Crypto.html" class="Module">Bitcoin.Tx.Crypto</a> <a id="205" class="Keyword">where</a>

<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="237" class="Keyword">hiding</a> <a id="244" class="Symbol">(</a><a id="245" href="Data.List.Base.html#6333" class="Function">allFin</a><a id="251" class="Symbol">)</a>
<a id="253" class="Keyword">open</a> <a id="258" href="Prelude.Init.html#5268" class="Module">V</a> <a id="260" class="Keyword">using</a> <a id="266" class="Symbol">(</a><a id="267" href="Data.Vec.Base.html#5793" class="Function">replicate</a><a id="276" class="Symbol">;</a> <a id="278" href="Data.Vec.Base.html#2395" class="Function Operator">_[_]≔_</a><a id="284" class="Symbol">;</a> <a id="286" href="Data.Vec.Base.html#1614" class="Function">lookup</a><a id="292" class="Symbol">;</a> <a id="294" href="Data.Vec.Base.html#6020" class="Function">allFin</a><a id="300" class="Symbol">)</a>
<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="330" class="Keyword">open</a> <a id="335" class="Keyword">import</a> <a id="342" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>
<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Prelude.Bitstring.html" class="Module">Prelude.Bitstring</a>

<a id="442" class="Keyword">open</a> <a id="447" class="Keyword">import</a> <a id="454" href="Bitcoin.BasicTypes.html" class="Module">Bitcoin.BasicTypes</a>
<a id="473" class="Keyword">open</a> <a id="478" class="Keyword">import</a> <a id="485" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a>
<a id="500" class="Keyword">open</a> <a id="505" class="Keyword">import</a> <a id="512" href="Bitcoin.Tx.Base.html" class="Module">Bitcoin.Tx.Base</a>
<a id="528" class="Keyword">open</a> <a id="533" class="Keyword">import</a> <a id="540" href="Bitcoin.Script.Base.html" class="Module">Bitcoin.Script.Base</a>

<a id="561" class="Comment">-- Constructing transaction inputs</a>
<a id="_♯at_"></a><a id="596" href="Bitcoin.Tx.Crypto.html#596" class="Function Operator">_♯at_</a> <a id="602" class="Symbol">:</a> <a id="604" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="607" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="609" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="611" class="Symbol">→</a> <a id="613" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="617" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="619" class="Symbol">→</a> <a id="621" href="Bitcoin.Tx.Base.html#359" class="Record">TxInput</a>
<a id="629" href="Bitcoin.Tx.Crypto.html#629" class="Bound">tx</a> <a id="632" href="Bitcoin.Tx.Crypto.html#596" class="Function Operator">♯at</a> <a id="636" href="Bitcoin.Tx.Crypto.html#636" class="Bound">j</a> <a id="638" class="Symbol">=</a> <a id="640" class="Symbol">(</a><a id="641" href="Bitcoin.Tx.Crypto.html#629" class="Bound">tx</a> <a id="644" href="Bitcoin.Crypto.html#609" class="Postulate Operator">♯</a><a id="645" class="Symbol">)</a> <a id="647" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="650" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="654" href="Bitcoin.Tx.Crypto.html#636" class="Bound">j</a>

<a id="hashTxⁱ"></a><a id="657" href="Bitcoin.Tx.Crypto.html#657" class="Function">hashTxⁱ</a> <a id="665" class="Symbol">:</a> <a id="667" href="Bitcoin.Tx.Base.html#2008" class="Record">TxInput′</a> <a id="676" class="Symbol">→</a> <a id="678" href="Bitcoin.Tx.Base.html#359" class="Record">TxInput</a>
<a id="686" href="Bitcoin.Tx.Crypto.html#657" class="Function">hashTxⁱ</a> <a id="694" class="Symbol">((_</a> <a id="698" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="700" class="Symbol">_</a> <a id="702" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="704" href="Bitcoin.Tx.Crypto.html#704" class="Bound">tx</a><a id="706" class="Symbol">)</a> <a id="708" href="Bitcoin.Tx.Base.html#2044" class="InductiveConstructor Operator">at</a> <a id="711" href="Bitcoin.Tx.Crypto.html#711" class="Bound">j</a><a id="712" class="Symbol">)</a> <a id="714" class="Symbol">=</a> <a id="716" href="Bitcoin.Tx.Crypto.html#704" class="Bound">tx</a> <a id="719" href="Bitcoin.Tx.Crypto.html#596" class="Function Operator">♯at</a> <a id="723" href="Bitcoin.Tx.Crypto.html#711" class="Bound">j</a>

<a id="726" class="Comment">-- Remove witnesses (i.e. adhere to SegregatedWitness feature of Bitcoin)</a>
<a id="wit⊥"></a><a id="800" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a> <a id="805" class="Symbol">:</a> <a id="807" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="811" href="Bitcoin.Tx.Base.html#1078" class="Function">∃Witness</a> <a id="820" href="Bitcoin.BasicTypes.html#418" class="Generalizable">n</a>
<a id="822" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a> <a id="827" class="Symbol">=</a> <a id="829" href="Data.Vec.Base.html#5793" class="Function">replicate</a> <a id="839" class="Symbol">(</a><a id="840" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="843" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a><a id="845" class="Symbol">)</a>

<a id="wit→⊥"></a><a id="848" href="Bitcoin.Tx.Crypto.html#848" class="Function">wit→⊥</a> <a id="854" class="Symbol">:</a> <a id="856" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="859" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="861" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="863" class="Symbol">→</a> <a id="865" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="868" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="870" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="872" href="Bitcoin.Tx.Crypto.html#848" class="Function">wit→⊥</a> <a id="878" href="Bitcoin.Tx.Crypto.html#878" class="Bound">tx</a> <a id="881" class="Symbol">=</a> <a id="883" class="Keyword">record</a> <a id="890" href="Bitcoin.Tx.Crypto.html#878" class="Bound">tx</a> <a id="893" class="Symbol">{</a> <a id="895" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="899" class="Symbol">=</a> <a id="901" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a> <a id="906" class="Symbol">}</a>

<a id="909" class="Comment">-- Transaction signatures</a>
<a id="μ"></a><a id="935" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="937" class="Symbol">:</a> <a id="939" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="942" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="944" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="946" class="Symbol">→</a> <a id="948" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="952" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="954" class="Symbol">→</a> <a id="956" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="959" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="961" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="963" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="965" class="Symbol">{</a><a id="966" class="Argument">i</a> <a id="968" class="Symbol">=</a> <a id="970" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="974" class="Symbol">_}</a> <a id="977" href="Bitcoin.Tx.Crypto.html#977" class="Bound">tx</a> <a id="980" href="Bitcoin.Tx.Crypto.html#980" class="Bound">j</a> <a id="982" class="Symbol">=</a> <a id="984" class="Keyword">record</a> <a id="991" href="Bitcoin.Tx.Crypto.html#977" class="Bound">tx</a> <a id="994" class="Symbol">{</a> <a id="996" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="1000" class="Symbol">=</a> <a id="1002" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a> <a id="1007" href="Data.Vec.Base.html#2395" class="Function Operator">[</a> <a id="1009" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="1012" href="Data.Vec.Base.html#2395" class="Function Operator">]≔</a> <a id="1015" class="Symbol">(</a><a id="1016" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1019" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1021" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1023" class="Symbol">(</a><a id="1024" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="1028" href="Bitcoin.Tx.Crypto.html#980" class="Bound">j</a><a id="1029" class="Symbol">)</a> <a id="1031" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a><a id="1032" class="Symbol">)</a> <a id="1034" class="Symbol">}</a>

<a id="sig"></a><a id="1037" href="Bitcoin.Tx.Crypto.html#1037" class="Function">sig</a> <a id="1041" class="Symbol">:</a> <a id="1043" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1048" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="1056" class="Symbol">→</a> <a id="1058" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1061" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1063" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1065" class="Symbol">→</a> <a id="1067" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1071" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1073" class="Symbol">→</a> <a id="1075" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1078" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1080" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="1082" href="Bitcoin.Tx.Crypto.html#1037" class="Function">sig</a> <a id="1086" href="Bitcoin.Tx.Crypto.html#1086" class="Bound">ks</a> <a id="1089" href="Bitcoin.Tx.Crypto.html#1089" class="Bound">tx</a> <a id="1092" href="Bitcoin.Tx.Crypto.html#1092" class="Bound">j</a> <a id="1094" class="Symbol">=</a> <a id="1096" class="Keyword">record</a> <a id="1103" href="Bitcoin.Tx.Crypto.html#1089" class="Bound">tx</a>
  <a id="1108" class="Symbol">{</a> <a id="1110" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="1114" class="Symbol">=</a> <a id="1116" href="Bitcoin.Tx.Crypto.html#1089" class="Bound">tx</a> <a id="1119" class="Symbol">.</a><a id="1120" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="1124" href="Data.Vec.Base.html#2395" class="Function Operator">[</a> <a id="1126" href="Bitcoin.Tx.Crypto.html#1092" class="Bound">j</a> <a id="1128" href="Data.Vec.Base.html#2395" class="Function Operator">]≔</a> <a id="1131" class="Symbol">(</a><a id="1132" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1135" href="Prelude.FromList.html#206" class="Field">fromList</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Function.Base.html#1563" class="Function">flip</a> <a id="1150" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="1154" class="Symbol">(</a><a id="1155" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="1157" href="Bitcoin.Tx.Crypto.html#1089" class="Bound">tx</a> <a id="1160" href="Bitcoin.Tx.Crypto.html#1092" class="Bound">j</a><a id="1161" class="Symbol">)</a> <a id="1163" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1167" href="Bitcoin.Tx.Crypto.html#1086" class="Bound">ks</a><a id="1169" class="Symbol">))</a> <a id="1172" class="Symbol">}</a>

<a id="ver"></a><a id="1175" href="Bitcoin.Tx.Crypto.html#1175" class="Function">ver</a> <a id="1179" class="Symbol">:</a> <a id="1181" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="1189" class="Symbol">→</a> <a id="1191" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a> <a id="1198" class="Symbol">→</a> <a id="1200" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1203" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1205" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1207" class="Symbol">→</a> <a id="1209" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1213" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1215" class="Symbol">→</a> <a id="1217" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="1222" href="Bitcoin.Tx.Crypto.html#1175" class="Function">ver</a> <a id="1226" href="Bitcoin.Tx.Crypto.html#1226" class="Bound">k</a> <a id="1228" href="Bitcoin.Tx.Crypto.html#1228" class="Bound">σ</a> <a id="1230" href="Bitcoin.Tx.Crypto.html#1230" class="Bound">tx</a> <a id="1233" href="Bitcoin.Tx.Crypto.html#1233" class="Bound">j</a> <a id="1235" class="Symbol">=</a> <a id="1237" href="Bitcoin.Crypto.html#697" class="Postulate">VER</a> <a id="1241" href="Bitcoin.Tx.Crypto.html#1226" class="Bound">k</a> <a id="1243" href="Bitcoin.Tx.Crypto.html#1228" class="Bound">σ</a> <a id="1245" class="Symbol">(</a><a id="1246" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="1248" href="Bitcoin.Tx.Crypto.html#1230" class="Bound">tx</a> <a id="1251" href="Bitcoin.Tx.Crypto.html#1233" class="Bound">j</a><a id="1252" class="Symbol">)</a>

<a id="1255" class="Comment">-- m-of-n multi-signature scheme</a>
<a id="sig⋆"></a><a id="1288" href="Bitcoin.Tx.Crypto.html#1288" class="Function">sig⋆</a> <a id="1293" class="Symbol">:</a> <a id="1295" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="1299" class="Symbol">(</a><a id="1300" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1305" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a><a id="1312" class="Symbol">)</a> <a id="1314" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1316" class="Symbol">→</a> <a id="1318" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1321" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1323" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1325" class="Symbol">→</a> <a id="1327" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1330" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1332" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="1334" href="Bitcoin.Tx.Crypto.html#1288" class="Function">sig⋆</a> <a id="1339" href="Bitcoin.Tx.Crypto.html#1339" class="Bound">kss</a> <a id="1343" href="Bitcoin.Tx.Crypto.html#1343" class="Bound">tx</a> <a id="1346" class="Symbol">=</a> <a id="1348" class="Keyword">record</a> <a id="1355" href="Bitcoin.Tx.Crypto.html#1343" class="Bound">tx</a>
  <a id="1360" class="Symbol">{</a> <a id="1362" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="1366" class="Symbol">=</a> <a id="1368" class="Symbol">(λ</a> <a id="1371" href="Bitcoin.Tx.Crypto.html#1371" class="Bound">j</a> <a id="1373" class="Symbol">→</a> <a id="1375" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1378" href="Prelude.FromList.html#206" class="Field">fromList</a> <a id="1387" class="Symbol">(</a><a id="1388" href="Function.Base.html#1563" class="Function">flip</a> <a id="1393" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="1397" class="Symbol">(</a><a id="1398" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="1400" href="Bitcoin.Tx.Crypto.html#1343" class="Bound">tx</a> <a id="1403" href="Bitcoin.Tx.Crypto.html#1371" class="Bound">j</a><a id="1404" class="Symbol">)</a> <a id="1406" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1410" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="1417" href="Bitcoin.Tx.Crypto.html#1339" class="Bound">kss</a> <a id="1421" href="Bitcoin.Tx.Crypto.html#1371" class="Bound">j</a><a id="1422" class="Symbol">))</a> <a id="1425" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1429" href="Data.Vec.Base.html#6020" class="Function">allFin</a> <a id="1436" class="Symbol">_</a> <a id="1438" class="Symbol">}</a>

<a id="ver⋆"></a><a id="1441" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="1446" class="Symbol">:</a> <a id="1448" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1453" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="1461" class="Symbol">→</a> <a id="1463" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1468" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a> <a id="1475" class="Symbol">→</a> <a id="1477" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1480" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1482" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1490" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1492" class="Symbol">→</a> <a id="1494" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="1499" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="1504" class="Symbol">_</a>        <a id="1513" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="1522" class="Symbol">_</a> <a id="1524" class="Symbol">_</a> <a id="1526" class="Symbol">=</a> <a id="1528" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
<a id="1533" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="1538" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="1547" class="Symbol">(_</a> <a id="1550" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1552" class="Symbol">_)</a>  <a id="1556" class="Symbol">_</a> <a id="1558" class="Symbol">_</a> <a id="1560" class="Symbol">=</a> <a id="1562" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
<a id="1568" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Bitcoin.Tx.Crypto.html#1574" class="Bound">k</a> <a id="1576" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1578" href="Bitcoin.Tx.Crypto.html#1578" class="Bound">ks</a><a id="1580" class="Symbol">)</a> <a id="1582" class="Symbol">(</a><a id="1583" href="Bitcoin.Tx.Crypto.html#1583" class="Bound">σ</a> <a id="1585" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1587" href="Bitcoin.Tx.Crypto.html#1587" class="Bound">σs</a><a id="1589" class="Symbol">)</a> <a id="1591" href="Bitcoin.Tx.Crypto.html#1591" class="Bound">T</a> <a id="1593" href="Bitcoin.Tx.Crypto.html#1593" class="Bound">j</a> <a id="1595" class="Symbol">=</a>
  <a id="1599" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="1602" href="Bitcoin.Tx.Crypto.html#1175" class="Function">ver</a> <a id="1606" href="Bitcoin.Tx.Crypto.html#1574" class="Bound">k</a> <a id="1608" href="Bitcoin.Tx.Crypto.html#1583" class="Bound">σ</a> <a id="1610" href="Bitcoin.Tx.Crypto.html#1591" class="Bound">T</a> <a id="1612" href="Bitcoin.Tx.Crypto.html#1593" class="Bound">j</a> <a id="1614" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="1619" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="1624" href="Bitcoin.Tx.Crypto.html#1578" class="Bound">ks</a> <a id="1627" href="Bitcoin.Tx.Crypto.html#1587" class="Bound">σs</a> <a id="1630" href="Bitcoin.Tx.Crypto.html#1591" class="Bound">T</a> <a id="1632" href="Bitcoin.Tx.Crypto.html#1593" class="Bound">j</a> <a id="1634" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="1639" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="1644" href="Bitcoin.Tx.Crypto.html#1578" class="Bound">ks</a> <a id="1647" class="Symbol">(</a><a id="1648" href="Bitcoin.Tx.Crypto.html#1583" class="Bound">σ</a> <a id="1650" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1652" href="Bitcoin.Tx.Crypto.html#1587" class="Bound">σs</a><a id="1654" class="Symbol">)</a> <a id="1656" href="Bitcoin.Tx.Crypto.html#1591" class="Bound">T</a> <a id="1658" href="Bitcoin.Tx.Crypto.html#1593" class="Bound">j</a>

<a id="ver⋆sig≡"></a><a id="1661" href="Bitcoin.Tx.Crypto.html#1661" class="Function">ver⋆sig≡</a> <a id="1670" class="Symbol">:</a> <a id="1672" class="Symbol">∀</a> <a id="1674" class="Symbol">{</a><a id="1675" href="Bitcoin.Tx.Crypto.html#1675" class="Bound">k</a><a id="1676" class="Symbol">}</a> <a id="1678" class="Symbol">(</a><a id="1679" href="Bitcoin.Tx.Crypto.html#1679" class="Bound">t</a> <a id="1681" class="Symbol">:</a> <a id="1683" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1686" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1688" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a><a id="1689" class="Symbol">)</a> <a id="1691" class="Symbol">(</a><a id="1692" href="Bitcoin.Tx.Crypto.html#1692" class="Bound">j</a> <a id="1694" class="Symbol">:</a> <a id="1696" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1700" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a><a id="1701" class="Symbol">)</a> <a id="1703" class="Symbol">→</a> <a id="1705" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="1707" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1709" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="1714" href="Data.List.Base.html#5034" class="Function Operator">L.[</a> <a id="1718" href="Bitcoin.Tx.Crypto.html#1675" class="Bound">k</a> <a id="1720" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1722" href="Data.List.Base.html#5034" class="Function Operator">L.[</a> <a id="1726" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="1730" href="Bitcoin.Tx.Crypto.html#1675" class="Bound">k</a> <a id="1732" class="Symbol">(</a><a id="1733" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="1735" href="Bitcoin.Tx.Crypto.html#1679" class="Bound">t</a> <a id="1737" href="Bitcoin.Tx.Crypto.html#1692" class="Bound">j</a><a id="1738" class="Symbol">)</a> <a id="1740" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1742" href="Bitcoin.Tx.Crypto.html#1679" class="Bound">t</a> <a id="1744" href="Bitcoin.Tx.Crypto.html#1692" class="Bound">j</a>
<a id="1746" href="Bitcoin.Tx.Crypto.html#1661" class="Function">ver⋆sig≡</a> <a id="1755" class="Symbol">{</a><a id="1756" class="Argument">k</a> <a id="1758" class="Symbol">=</a> <a id="1760" href="Bitcoin.Tx.Crypto.html#1760" class="Bound">k</a><a id="1761" class="Symbol">}</a> <a id="1763" href="Bitcoin.Tx.Crypto.html#1763" class="Bound">t</a> <a id="1765" href="Bitcoin.Tx.Crypto.html#1765" class="Bound">j</a> <a id="1767" class="Keyword">rewrite</a> <a id="1775" href="Prelude.General.html#5371" class="Function">if-eta</a> <a id="1782" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1784" href="Bitcoin.Tx.Crypto.html#1175" class="Function">ver</a> <a id="1788" href="Bitcoin.Tx.Crypto.html#1760" class="Bound">k</a> <a id="1790" class="Symbol">(</a><a id="1791" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="1795" href="Bitcoin.Tx.Crypto.html#1760" class="Bound">k</a> <a id="1797" class="Symbol">(</a><a id="1798" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="1800" href="Bitcoin.Tx.Crypto.html#1763" class="Bound">t</a> <a id="1802" href="Bitcoin.Tx.Crypto.html#1765" class="Bound">j</a><a id="1803" class="Symbol">))</a> <a id="1806" href="Bitcoin.Tx.Crypto.html#1763" class="Bound">t</a> <a id="1808" href="Bitcoin.Tx.Crypto.html#1765" class="Bound">j</a> <a id="1810" class="Symbol">=</a> <a id="1812" href="Bitcoin.Crypto.html#911" class="Function">VERSIG≡</a>

<a id="1821" class="Keyword">module</a> <a id="Example1"></a><a id="1828" href="Bitcoin.Tx.Crypto.html#1828" class="Module">Example1</a>
  <a id="1839" class="Symbol">(</a><a id="1840" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="1843" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="1846" href="Bitcoin.Tx.Crypto.html#1846" class="Bound">kᶜ</a> <a id="1849" class="Symbol">:</a> <a id="1851" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a><a id="1858" class="Symbol">)</a>
  <a id="1862" class="Symbol">(</a><a id="1863" href="Bitcoin.Tx.Crypto.html#1863" class="Bound">kᶜ≢kᵇ</a> <a id="1869" class="Symbol">:</a> <a id="1871" href="Bitcoin.Tx.Crypto.html#1846" class="Bound">kᶜ</a> <a id="1874" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1876" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a><a id="1878" class="Symbol">)</a> <a id="1880" class="Symbol">(</a><a id="1881" href="Bitcoin.Tx.Crypto.html#1881" class="Bound">kᶜ≢kᵃ</a> <a id="1887" class="Symbol">:</a> <a id="1889" href="Bitcoin.Tx.Crypto.html#1846" class="Bound">kᶜ</a> <a id="1892" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1894" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a><a id="1896" class="Symbol">)</a> <a id="1898" class="Symbol">(</a><a id="1899" href="Bitcoin.Tx.Crypto.html#1899" class="Bound">kᵇ≢kᵃ</a> <a id="1905" class="Symbol">:</a> <a id="1907" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="1910" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1912" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a><a id="1914" class="Symbol">)</a>
  <a id="1918" class="Symbol">(</a><a id="1919" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="1921" class="Symbol">:</a> <a id="1923" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1926" class="Symbol">(</a><a id="1927" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1931" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a><a id="1932" class="Symbol">)</a> <a id="1934" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a><a id="1935" class="Symbol">)</a>
  <a id="1939" class="Keyword">where</a>
  <a id="Example1.σp"></a><a id="1947" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="1950" class="Symbol">=</a> <a id="1952" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="1956" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="1959" class="Symbol">(</a><a id="1960" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="1962" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="1964" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="1966" class="Symbol">)</a>
  <a id="Example1.σq"></a><a id="1970" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="1973" class="Symbol">=</a> <a id="1975" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="1979" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="1982" class="Symbol">(</a><a id="1983" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="1985" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="1987" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="1989" class="Symbol">)</a>

  <a id="Example1.ks"></a><a id="1994" href="Bitcoin.Tx.Crypto.html#1994" class="Function">ks</a>  <a id="1998" class="Symbol">=</a> <a id="2000" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2005" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="2013" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="2015" href="Prelude.Init.html#9927" class="InductiveConstructor Operator">[</a> <a id="2017" href="Bitcoin.Tx.Crypto.html#1846" class="Bound">kᶜ</a> <a id="2020" href="Prelude.Init.html#9927" class="InductiveConstructor Operator">⨾</a> <a id="2022" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="2025" href="Prelude.Init.html#9927" class="InductiveConstructor Operator">⨾</a> <a id="2027" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2030" href="Prelude.Init.html#9927" class="InductiveConstructor Operator">]</a>
  <a id="Example1.σs"></a><a id="2034" href="Bitcoin.Tx.Crypto.html#2034" class="Function">σs</a>  <a id="2038" class="Symbol">=</a> <a id="2040" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2045" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a>  <a id="2053" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="2055" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2057" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="2060" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2062" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2065" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>
  <a id="Example1.σs′"></a><a id="2069" href="Bitcoin.Tx.Crypto.html#2069" class="Function">σs′</a> <a id="2073" class="Symbol">=</a> <a id="2075" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2080" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a>  <a id="2088" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="2090" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2092" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2095" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2097" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="2100" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>

  <a id="2105" class="Comment">-- ** using equational reasoning</a>

  <a id="2141" class="Keyword">open</a> <a id="2146" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a>

  <a id="2161" href="Bitcoin.Tx.Crypto.html#2161" class="Function">_</a> <a id="2163" class="Symbol">:</a> <a id="2165" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2167" class="Symbol">(</a><a id="2168" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2173" href="Bitcoin.Tx.Crypto.html#1994" class="Function">ks</a> <a id="2176" href="Bitcoin.Tx.Crypto.html#2034" class="Function">σs</a> <a id="2179" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2181" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2183" class="Symbol">)</a>
  <a id="2187" class="Symbol">_</a> <a id="2189" class="Symbol">=</a> <a id="2191" href="Prelude.General.html#4125" class="Function">true⇒T</a>
    <a id="2202" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2204" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a>
        <a id="2218" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2223" href="Bitcoin.Tx.Crypto.html#1994" class="Function">ks</a> <a id="2226" href="Bitcoin.Tx.Crypto.html#2034" class="Function">σs</a> <a id="2229" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2231" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2240" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2252" class="Symbol">(</a><a id="2253" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2256" href="Bitcoin.Crypto.html#697" class="Postulate">VER</a> <a id="2260" href="Bitcoin.Tx.Crypto.html#1846" class="Bound">kᶜ</a> <a id="2263" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="2266" class="Symbol">(</a><a id="2267" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="2269" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2271" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2273" class="Symbol">)</a> <a id="2275" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
          <a id="2290" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2295" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2297" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="2300" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2302" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2305" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="2307" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2309" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2312" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2314" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2316" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
        <a id="2327" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
          <a id="2342" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2347" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2349" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="2352" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2354" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2357" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="2359" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2361" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="2364" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2366" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2369" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="2371" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2373" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2375" class="Symbol">)</a>
      <a id="2383" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2386" href="Prelude.General.html#5283" class="Function">if-false</a> <a id="2395" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2397" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="2406" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2408" href="Bitcoin.Crypto.html#973" class="Function">VERSIG≢</a> <a id="2416" href="Bitcoin.Tx.Crypto.html#1863" class="Bound">kᶜ≢kᵇ</a> <a id="2422" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="2432" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2437" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2439" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="2442" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2444" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2447" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="2449" href="Bitcoin.Tx.Crypto.html#2034" class="Function">σs</a> <a id="2452" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2454" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2463" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2475" class="Symbol">(</a><a id="2476" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2479" href="Bitcoin.Crypto.html#697" class="Postulate">VER</a> <a id="2483" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="2486" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="2489" class="Symbol">(</a><a id="2490" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="2492" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2494" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2496" class="Symbol">)</a> <a id="2498" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
          <a id="2513" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2518" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2520" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2523" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2525" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2527" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2530" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2532" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2534" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
        <a id="2545" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
          <a id="2560" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2565" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2567" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2570" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2572" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2574" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="2577" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2579" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2582" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="2584" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2586" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2588" class="Symbol">)</a>
      <a id="2596" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2599" href="Prelude.General.html#5198" class="Function">if-true</a> <a id="2607" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2609" href="Prelude.General.html#4167" class="Function">T⇒true</a> <a id="2616" href="Bitcoin.Crypto.html#911" class="Function">VERSIG≡</a> <a id="2624" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="2634" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2639" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2641" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2644" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2646" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2648" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2651" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2653" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2655" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2664" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2676" class="Symbol">(</a><a id="2677" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2680" href="Bitcoin.Crypto.html#697" class="Postulate">VER</a> <a id="2684" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="2687" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2690" class="Symbol">(</a><a id="2691" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="2693" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2695" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2697" class="Symbol">)</a> <a id="2699" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
          <a id="2714" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2719" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2722" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2725" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2727" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
        <a id="2738" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
          <a id="2753" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2758" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2761" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2763" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="2766" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2768" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2770" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2772" class="Symbol">)</a>
      <a id="2780" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2783" href="Prelude.General.html#5198" class="Function">if-true</a> <a id="2791" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2793" href="Prelude.General.html#4167" class="Function">T⇒true</a> <a id="2800" href="Bitcoin.Crypto.html#911" class="Function">VERSIG≡</a> <a id="2808" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="2818" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2823" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2826" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2829" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2831" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2840" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2852" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
      <a id="2863" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>

  <a id="2868" href="Bitcoin.Tx.Crypto.html#2868" class="Function">_</a> <a id="2870" class="Symbol">:</a> <a id="2872" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="2874" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2876" class="Symbol">(</a><a id="2877" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2882" href="Bitcoin.Tx.Crypto.html#1994" class="Function">ks</a> <a id="2885" href="Bitcoin.Tx.Crypto.html#2069" class="Function">σs′</a> <a id="2889" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2891" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2893" class="Symbol">)</a>
  <a id="2897" class="Symbol">_</a> <a id="2899" class="Symbol">=</a> <a id="2901" href="Prelude.General.html#4216" class="Function">false⇒¬T</a>
    <a id="2914" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2916" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a>
        <a id="2930" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="2935" href="Bitcoin.Tx.Crypto.html#1994" class="Function">ks</a> <a id="2938" href="Bitcoin.Tx.Crypto.html#2069" class="Function">σs′</a> <a id="2942" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="2944" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2953" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2956" href="Prelude.General.html#5283" class="Function">if-false</a> <a id="2965" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2967" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="2976" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2978" href="Bitcoin.Crypto.html#973" class="Function">VERSIG≢</a> <a id="2986" href="Bitcoin.Tx.Crypto.html#1881" class="Bound">kᶜ≢kᵃ</a> <a id="2992" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="3002" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="3007" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="3009" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a> <a id="3012" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="3014" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="3017" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="3019" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="3021" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="3024" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="3026" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="3029" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="3031" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3033" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="3042" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="3045" href="Prelude.General.html#5283" class="Function">if-false</a> <a id="3054" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3056" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3065" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3067" href="Bitcoin.Crypto.html#973" class="Function">VERSIG≢</a> <a id="3075" href="Bitcoin.Tx.Crypto.html#1899" class="Bound">kᵇ≢kᵃ</a> <a id="3081" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="3091" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="3096" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="3098" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a> <a id="3101" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="3103" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="3105" href="Bitcoin.Tx.Crypto.html#1947" class="Function">σp</a> <a id="3108" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="3110" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="3113" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a> <a id="3115" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3117" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="3126" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="3129" href="Prelude.General.html#5198" class="Function">if-true</a> <a id="3137" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3139" href="Prelude.General.html#4167" class="Function">T⇒true</a> <a id="3146" href="Bitcoin.Crypto.html#911" class="Function">VERSIG≡</a> <a id="3154" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="3164" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="3169" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="3172" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="3174" href="Bitcoin.Tx.Crypto.html#1970" class="Function">σq</a> <a id="3177" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="3179" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3181" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="3190" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="3202" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
      <a id="3214" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>

  <a id="3219" class="Comment">-- ** using `rewrite`</a>

  <a id="3244" href="Bitcoin.Tx.Crypto.html#3244" class="Function">_</a> <a id="3246" class="Symbol">:</a> <a id="3248" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="3250" class="Symbol">(</a><a id="3251" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="3256" href="Bitcoin.Tx.Crypto.html#1994" class="Function">ks</a> <a id="3259" href="Bitcoin.Tx.Crypto.html#2034" class="Function">σs</a> <a id="3262" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3264" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3266" class="Symbol">)</a>
  <a id="3270" class="Symbol">_</a> <a id="3272" class="Keyword">rewrite</a> <a id="3280" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3289" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3291" href="Bitcoin.Crypto.html#973" class="Function">VERSIG≢</a> <a id="3299" class="Symbol">{</a><a id="3300" class="Argument">x</a> <a id="3302" class="Symbol">=</a> <a id="3304" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="3306" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3308" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3310" class="Symbol">}</a> <a id="3312" href="Bitcoin.Tx.Crypto.html#1863" class="Bound">kᶜ≢kᵇ</a>
          <a id="3328" class="Symbol">|</a> <a id="3330" href="Prelude.General.html#4167" class="Function">T⇒true</a>   <a id="3339" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3341" href="Bitcoin.Crypto.html#911" class="Function">VERSIG≡</a> <a id="3349" class="Symbol">{</a><a id="3350" class="Argument">k</a> <a id="3352" class="Symbol">=</a> <a id="3354" href="Bitcoin.Tx.Crypto.html#1843" class="Bound">kᵇ</a><a id="3356" class="Symbol">}</a> <a id="3358" class="Symbol">{</a><a id="3359" class="Argument">x</a> <a id="3361" class="Symbol">=</a> <a id="3363" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="3365" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3367" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3369" class="Symbol">}</a>
          <a id="3381" class="Symbol">|</a> <a id="3383" href="Prelude.General.html#4167" class="Function">T⇒true</a>   <a id="3392" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3394" href="Bitcoin.Crypto.html#911" class="Function">VERSIG≡</a> <a id="3402" class="Symbol">{</a><a id="3403" class="Argument">k</a> <a id="3405" class="Symbol">=</a> <a id="3407" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a><a id="3409" class="Symbol">}</a> <a id="3411" class="Symbol">{</a><a id="3412" class="Argument">x</a> <a id="3414" class="Symbol">=</a> <a id="3416" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="3418" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3420" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3422" class="Symbol">}</a>
          <a id="3434" class="Symbol">=</a> <a id="3436" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a>

  <a id="3442" href="Bitcoin.Tx.Crypto.html#3442" class="Function">_</a> <a id="3444" class="Symbol">:</a> <a id="3446" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="3448" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="3450" class="Symbol">(</a><a id="3451" href="Bitcoin.Tx.Crypto.html#1441" class="Function">ver⋆</a> <a id="3456" href="Bitcoin.Tx.Crypto.html#1994" class="Function">ks</a> <a id="3459" href="Bitcoin.Tx.Crypto.html#2069" class="Function">σs′</a> <a id="3463" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3465" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3467" class="Symbol">)</a>
  <a id="3471" class="Symbol">_</a> <a id="3473" class="Keyword">rewrite</a> <a id="3481" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3490" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3492" href="Bitcoin.Crypto.html#973" class="Function">VERSIG≢</a> <a id="3500" class="Symbol">{</a><a id="3501" class="Argument">x</a> <a id="3503" class="Symbol">=</a> <a id="3505" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="3507" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3509" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3511" class="Symbol">}</a> <a id="3513" href="Bitcoin.Tx.Crypto.html#1881" class="Bound">kᶜ≢kᵃ</a>
          <a id="3529" class="Symbol">|</a> <a id="3531" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3540" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3542" href="Bitcoin.Crypto.html#973" class="Function">VERSIG≢</a> <a id="3550" class="Symbol">{</a><a id="3551" class="Argument">x</a> <a id="3553" class="Symbol">=</a> <a id="3555" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="3557" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3559" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3561" class="Symbol">}</a> <a id="3563" href="Bitcoin.Tx.Crypto.html#1899" class="Bound">kᵇ≢kᵃ</a>
          <a id="3579" class="Symbol">|</a> <a id="3581" href="Prelude.General.html#4167" class="Function">T⇒true</a>   <a id="3590" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3592" href="Bitcoin.Crypto.html#911" class="Function">VERSIG≡</a> <a id="3600" class="Symbol">{</a><a id="3601" class="Argument">k</a> <a id="3603" class="Symbol">=</a> <a id="3605" href="Bitcoin.Tx.Crypto.html#1840" class="Bound">kᵃ</a><a id="3607" class="Symbol">}</a> <a id="3609" class="Symbol">{</a><a id="3610" class="Argument">x</a> <a id="3612" class="Symbol">=</a> <a id="3614" href="Bitcoin.Tx.Crypto.html#935" class="Function">μ</a> <a id="3616" href="Bitcoin.Tx.Crypto.html#1919" class="Bound">t</a> <a id="3618" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3620" class="Symbol">}</a>
          <a id="3632" class="Symbol">=</a> <a id="3634" href="Function.Base.html#624" class="Function">id</a>
</pre></body></html>