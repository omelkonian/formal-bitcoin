<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Bitcoin.Tx.Crypto</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitcoin/tree/master/Bitcoin/Tx/Crypto.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Hashing/signing transactions.</a>
<a id="107" class="Comment">------------------------------------------------------------------------</a>
<a id="180" class="Keyword">module</a> <a id="187" href="Bitcoin.Tx.Crypto.html" class="Module">Bitcoin.Tx.Crypto</a> <a id="205" class="Keyword">where</a>

<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="237" class="Keyword">hiding</a> <a id="244" class="Symbol">(</a><a id="245" href="Data.List.Base.html#6333" class="Function">allFin</a><a id="251" class="Symbol">;</a> <a id="253" href="Data.List.Base.html#5034" class="Function Operator">[_]</a><a id="256" class="Symbol">)</a>
<a id="258" class="Keyword">open</a> <a id="263" href="Prelude.Init.html#5142" class="Module">V</a>
<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="345" class="Keyword">open</a> <a id="350" class="Keyword">import</a> <a id="357" href="Prelude.Bitstring.html" class="Module">Prelude.Bitstring</a>

<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Bitcoin.BasicTypes.html" class="Module">Bitcoin.BasicTypes</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a>
<a id="434" class="Keyword">open</a> <a id="439" class="Keyword">import</a> <a id="446" href="Bitcoin.Tx.Base.html" class="Module">Bitcoin.Tx.Base</a>
<a id="462" class="Keyword">open</a> <a id="467" class="Keyword">import</a> <a id="474" href="Bitcoin.Script.Base.html" class="Module">Bitcoin.Script.Base</a>

<a id="495" class="Comment">-- Constructing transaction inputs</a>
<a id="_♯at_"></a><a id="530" href="Bitcoin.Tx.Crypto.html#530" class="Function Operator">_♯at_</a> <a id="536" class="Symbol">:</a> <a id="538" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="541" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="543" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="545" class="Symbol">→</a> <a id="547" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="551" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="553" class="Symbol">→</a> <a id="555" href="Bitcoin.Tx.Base.html#359" class="Record">TxInput</a>
<a id="563" href="Bitcoin.Tx.Crypto.html#563" class="Bound">tx</a> <a id="566" href="Bitcoin.Tx.Crypto.html#530" class="Function Operator">♯at</a> <a id="570" href="Bitcoin.Tx.Crypto.html#570" class="Bound">i</a> <a id="572" class="Symbol">=</a> <a id="574" class="Symbol">(</a><a id="575" href="Bitcoin.Tx.Crypto.html#563" class="Bound">tx</a> <a id="578" href="Bitcoin.Crypto.html#669" class="Postulate Operator">♯</a><a id="579" class="Symbol">)</a> <a id="581" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="584" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="588" href="Bitcoin.Tx.Crypto.html#570" class="Bound">i</a>

<a id="hashTxⁱ"></a><a id="591" href="Bitcoin.Tx.Crypto.html#591" class="Function">hashTxⁱ</a> <a id="599" class="Symbol">:</a> <a id="601" href="Bitcoin.Tx.Base.html#2008" class="Record">TxInput′</a> <a id="610" class="Symbol">→</a> <a id="612" href="Bitcoin.Tx.Base.html#359" class="Record">TxInput</a>
<a id="620" href="Bitcoin.Tx.Crypto.html#591" class="Function">hashTxⁱ</a> <a id="628" class="Symbol">((_</a> <a id="632" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="634" class="Symbol">_</a> <a id="636" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="638" href="Bitcoin.Tx.Crypto.html#638" class="Bound">tx</a><a id="640" class="Symbol">)</a> <a id="642" href="Bitcoin.Tx.Base.html#2044" class="InductiveConstructor Operator">at</a> <a id="645" href="Bitcoin.Tx.Crypto.html#645" class="Bound">i</a><a id="646" class="Symbol">)</a> <a id="648" class="Symbol">=</a> <a id="650" href="Bitcoin.Tx.Crypto.html#638" class="Bound">tx</a> <a id="653" href="Bitcoin.Tx.Crypto.html#530" class="Function Operator">♯at</a> <a id="657" href="Bitcoin.Tx.Crypto.html#645" class="Bound">i</a>

<a id="660" class="Comment">-- Remove witnesses (i.e. adhere to SegregatedWitness feature of Bitcoin)</a>
<a id="wit⊥"></a><a id="734" href="Bitcoin.Tx.Crypto.html#734" class="Function">wit⊥</a> <a id="739" class="Symbol">:</a> <a id="741" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="745" href="Bitcoin.Tx.Base.html#1078" class="Function">∃Witness</a> <a id="754" href="Bitcoin.BasicTypes.html#289" class="Generalizable">n</a>
<a id="756" href="Bitcoin.Tx.Crypto.html#734" class="Function">wit⊥</a> <a id="761" class="Symbol">=</a> <a id="763" href="Data.Vec.Base.html#5793" class="Function">replicate</a> <a id="773" class="Symbol">(</a><a id="774" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="777" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a><a id="779" class="Symbol">)</a>

<a id="wit→⊥"></a><a id="782" href="Bitcoin.Tx.Crypto.html#782" class="Function">wit→⊥</a> <a id="788" class="Symbol">:</a> <a id="790" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="793" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="795" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="797" class="Symbol">→</a> <a id="799" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="802" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="804" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="806" href="Bitcoin.Tx.Crypto.html#782" class="Function">wit→⊥</a> <a id="812" href="Bitcoin.Tx.Crypto.html#812" class="Bound">tx</a> <a id="815" class="Symbol">=</a> <a id="817" class="Keyword">record</a> <a id="824" href="Bitcoin.Tx.Crypto.html#812" class="Bound">tx</a> <a id="827" class="Symbol">{</a> <a id="829" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="833" class="Symbol">=</a> <a id="835" href="Bitcoin.Tx.Crypto.html#734" class="Function">wit⊥</a> <a id="840" class="Symbol">}</a>

<a id="843" class="Comment">-- Transaction signatures</a>
<a id="μ"></a><a id="869" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="871" class="Symbol">:</a> <a id="873" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="876" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="878" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="880" class="Symbol">→</a> <a id="882" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="886" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="888" class="Symbol">→</a> <a id="890" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="893" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="895" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="897" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="899" class="Symbol">{</a><a id="900" class="Argument">i</a> <a id="902" class="Symbol">=</a> <a id="904" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="908" class="Symbol">_}</a> <a id="911" href="Bitcoin.Tx.Crypto.html#911" class="Bound">tx</a> <a id="914" href="Bitcoin.Tx.Crypto.html#914" class="Bound">i′</a> <a id="917" class="Symbol">=</a> <a id="919" class="Keyword">record</a> <a id="926" href="Bitcoin.Tx.Crypto.html#911" class="Bound">tx</a> <a id="929" class="Symbol">{</a> <a id="931" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="935" class="Symbol">=</a> <a id="937" href="Bitcoin.Tx.Crypto.html#734" class="Function">wit⊥</a> <a id="942" href="Data.Vec.Base.html#2395" class="Function Operator">[</a> <a id="944" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="947" href="Data.Vec.Base.html#2395" class="Function Operator">]≔</a> <a id="950" class="Symbol">(</a><a id="951" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="954" href="Data.Vec.Base.html#5759" class="Function Operator">[</a> <a id="956" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="958" class="Symbol">(</a><a id="959" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="963" href="Bitcoin.Tx.Crypto.html#914" class="Bound">i′</a><a id="965" class="Symbol">)</a> <a id="967" href="Data.Vec.Base.html#5759" class="Function Operator">]</a><a id="968" class="Symbol">)</a> <a id="970" class="Symbol">}</a>

<a id="sig"></a><a id="973" href="Bitcoin.Tx.Crypto.html#973" class="Function">sig</a> <a id="977" class="Symbol">:</a> <a id="979" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="984" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="992" class="Symbol">→</a> <a id="994" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="997" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="999" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1001" class="Symbol">→</a> <a id="1003" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1007" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1009" class="Symbol">→</a> <a id="1011" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1014" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1016" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="1018" href="Bitcoin.Tx.Crypto.html#973" class="Function">sig</a> <a id="1022" href="Bitcoin.Tx.Crypto.html#1022" class="Bound">ks</a> <a id="1025" href="Bitcoin.Tx.Crypto.html#1025" class="Bound">tx</a> <a id="1028" href="Bitcoin.Tx.Crypto.html#1028" class="Bound">i</a> <a id="1030" class="Symbol">=</a> <a id="1032" class="Keyword">record</a> <a id="1039" href="Bitcoin.Tx.Crypto.html#1025" class="Bound">tx</a>
  <a id="1044" class="Symbol">{</a> <a id="1046" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="1050" class="Symbol">=</a> <a id="1052" href="Bitcoin.Tx.Crypto.html#1025" class="Bound">tx</a> <a id="1055" class="Symbol">.</a><a id="1056" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="1060" href="Data.Vec.Base.html#2395" class="Function Operator">[</a> <a id="1062" href="Bitcoin.Tx.Crypto.html#1028" class="Bound">i</a> <a id="1064" href="Data.Vec.Base.html#2395" class="Function Operator">]≔</a> <a id="1067" class="Symbol">(</a><a id="1068" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1071" href="Data.Vec.Base.html#7549" class="Function">fromList</a> <a id="1080" class="Symbol">(</a><a id="1081" href="Function.Base.html#1563" class="Function">flip</a> <a id="1086" href="Bitcoin.Crypto.html#715" class="Postulate">SIG</a> <a id="1090" class="Symbol">(</a><a id="1091" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="1093" href="Bitcoin.Tx.Crypto.html#1025" class="Bound">tx</a> <a id="1096" href="Bitcoin.Tx.Crypto.html#1028" class="Bound">i</a><a id="1097" class="Symbol">)</a> <a id="1099" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1103" href="Bitcoin.Tx.Crypto.html#1022" class="Bound">ks</a><a id="1105" class="Symbol">))</a> <a id="1108" class="Symbol">}</a>

<a id="ver"></a><a id="1111" href="Bitcoin.Tx.Crypto.html#1111" class="Function">ver</a> <a id="1115" class="Symbol">:</a> <a id="1117" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="1125" class="Symbol">→</a> <a id="1127" href="Bitcoin.BasicTypes.html#244" class="Function">HashId</a> <a id="1134" class="Symbol">→</a> <a id="1136" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1139" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1141" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1143" class="Symbol">→</a> <a id="1145" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1149" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1151" class="Symbol">→</a> <a id="1153" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="1158" href="Bitcoin.Tx.Crypto.html#1111" class="Function">ver</a> <a id="1162" href="Bitcoin.Tx.Crypto.html#1162" class="Bound">k</a> <a id="1164" href="Bitcoin.Tx.Crypto.html#1164" class="Bound">σ</a> <a id="1166" href="Bitcoin.Tx.Crypto.html#1166" class="Bound">tx</a> <a id="1169" href="Bitcoin.Tx.Crypto.html#1169" class="Bound">i</a> <a id="1171" class="Symbol">=</a> <a id="1173" href="Bitcoin.Crypto.html#744" class="Postulate">VER</a> <a id="1177" href="Bitcoin.Tx.Crypto.html#1162" class="Bound">k</a> <a id="1179" href="Bitcoin.Tx.Crypto.html#1164" class="Bound">σ</a> <a id="1181" class="Symbol">(</a><a id="1182" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="1184" href="Bitcoin.Tx.Crypto.html#1166" class="Bound">tx</a> <a id="1187" href="Bitcoin.Tx.Crypto.html#1169" class="Bound">i</a><a id="1188" class="Symbol">)</a>

<a id="1191" class="Comment">-- m-of-n multi-signature scheme</a>
<a id="sig⋆"></a><a id="1224" href="Bitcoin.Tx.Crypto.html#1224" class="Function">sig⋆</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="1235" class="Symbol">(</a><a id="1236" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1241" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a><a id="1248" class="Symbol">)</a> <a id="1250" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1252" class="Symbol">→</a> <a id="1254" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1257" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1259" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1261" class="Symbol">→</a> <a id="1263" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1266" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1268" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a>
<a id="1270" href="Bitcoin.Tx.Crypto.html#1224" class="Function">sig⋆</a> <a id="1275" href="Bitcoin.Tx.Crypto.html#1275" class="Bound">kss</a> <a id="1279" href="Bitcoin.Tx.Crypto.html#1279" class="Bound">tx</a> <a id="1282" class="Symbol">=</a> <a id="1284" class="Keyword">record</a> <a id="1291" href="Bitcoin.Tx.Crypto.html#1279" class="Bound">tx</a>
  <a id="1296" class="Symbol">{</a> <a id="1298" href="Bitcoin.Tx.Base.html#1193" class="Field">wit</a> <a id="1302" class="Symbol">=</a> <a id="1304" class="Symbol">(λ</a> <a id="1307" href="Bitcoin.Tx.Crypto.html#1307" class="Bound">i</a> <a id="1309" class="Symbol">→</a> <a id="1311" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1314" href="Data.Vec.Base.html#7549" class="Function">fromList</a> <a id="1323" class="Symbol">(</a><a id="1324" href="Function.Base.html#1563" class="Function">flip</a> <a id="1329" href="Bitcoin.Crypto.html#715" class="Postulate">SIG</a> <a id="1333" class="Symbol">(</a><a id="1334" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="1336" href="Bitcoin.Tx.Crypto.html#1279" class="Bound">tx</a> <a id="1339" href="Bitcoin.Tx.Crypto.html#1307" class="Bound">i</a><a id="1340" class="Symbol">)</a> <a id="1342" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1346" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="1353" href="Bitcoin.Tx.Crypto.html#1275" class="Bound">kss</a> <a id="1357" href="Bitcoin.Tx.Crypto.html#1307" class="Bound">i</a><a id="1358" class="Symbol">))</a> <a id="1361" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1365" href="Data.Vec.Base.html#6020" class="Function">allFin</a> <a id="1372" class="Symbol">_</a> <a id="1374" class="Symbol">}</a>

<a id="ver⋆"></a><a id="1377" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="1382" class="Symbol">:</a> <a id="1384" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1389" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="1397" class="Symbol">→</a> <a id="1399" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1404" href="Bitcoin.BasicTypes.html#244" class="Function">HashId</a> <a id="1411" class="Symbol">→</a> <a id="1413" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1416" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1418" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a> <a id="1420" class="Symbol">→</a> <a id="1422" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1426" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1428" class="Symbol">→</a> <a id="1430" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="1435" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="1440" class="Symbol">_</a>        <a id="1449" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="1458" class="Symbol">_</a> <a id="1460" class="Symbol">_</a> <a id="1462" class="Symbol">=</a> <a id="1464" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
<a id="1469" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="1474" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="1483" class="Symbol">(_</a> <a id="1486" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1488" class="Symbol">_)</a>  <a id="1492" class="Symbol">_</a> <a id="1494" class="Symbol">_</a> <a id="1496" class="Symbol">=</a> <a id="1498" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
<a id="1504" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="1509" class="Symbol">(</a><a id="1510" href="Bitcoin.Tx.Crypto.html#1510" class="Bound">k</a> <a id="1512" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1514" href="Bitcoin.Tx.Crypto.html#1514" class="Bound">ks</a><a id="1516" class="Symbol">)</a> <a id="1518" class="Symbol">(</a><a id="1519" href="Bitcoin.Tx.Crypto.html#1519" class="Bound">σ</a> <a id="1521" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1523" href="Bitcoin.Tx.Crypto.html#1523" class="Bound">σs</a><a id="1525" class="Symbol">)</a> <a id="1527" href="Bitcoin.Tx.Crypto.html#1527" class="Bound">T</a> <a id="1529" href="Bitcoin.Tx.Crypto.html#1529" class="Bound">i</a> <a id="1531" class="Symbol">=</a>
  <a id="1535" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="1538" href="Bitcoin.Tx.Crypto.html#1111" class="Function">ver</a> <a id="1542" href="Bitcoin.Tx.Crypto.html#1510" class="Bound">k</a> <a id="1544" href="Bitcoin.Tx.Crypto.html#1519" class="Bound">σ</a> <a id="1546" href="Bitcoin.Tx.Crypto.html#1527" class="Bound">T</a> <a id="1548" href="Bitcoin.Tx.Crypto.html#1529" class="Bound">i</a> <a id="1550" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="1555" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="1560" href="Bitcoin.Tx.Crypto.html#1514" class="Bound">ks</a> <a id="1563" href="Bitcoin.Tx.Crypto.html#1523" class="Bound">σs</a> <a id="1566" href="Bitcoin.Tx.Crypto.html#1527" class="Bound">T</a> <a id="1568" href="Bitcoin.Tx.Crypto.html#1529" class="Bound">i</a> <a id="1570" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="1575" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="1580" href="Bitcoin.Tx.Crypto.html#1514" class="Bound">ks</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Bitcoin.Tx.Crypto.html#1519" class="Bound">σ</a> <a id="1586" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1588" href="Bitcoin.Tx.Crypto.html#1523" class="Bound">σs</a><a id="1590" class="Symbol">)</a> <a id="1592" href="Bitcoin.Tx.Crypto.html#1527" class="Bound">T</a> <a id="1594" href="Bitcoin.Tx.Crypto.html#1529" class="Bound">i</a>

<a id="ver⋆sig≡"></a><a id="1597" href="Bitcoin.Tx.Crypto.html#1597" class="Function">ver⋆sig≡</a> <a id="1606" class="Symbol">:</a> <a id="1608" class="Symbol">∀</a> <a id="1610" class="Symbol">{</a><a id="1611" href="Bitcoin.Tx.Crypto.html#1611" class="Bound">k</a><a id="1612" class="Symbol">}</a> <a id="1614" class="Symbol">(</a><a id="1615" href="Bitcoin.Tx.Crypto.html#1615" class="Bound">t</a> <a id="1617" class="Symbol">:</a> <a id="1619" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1622" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a> <a id="1624" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a><a id="1625" class="Symbol">)</a> <a id="1627" class="Symbol">(</a><a id="1628" href="Bitcoin.Tx.Crypto.html#1628" class="Bound">j</a> <a id="1630" class="Symbol">:</a> <a id="1632" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1636" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a><a id="1637" class="Symbol">)</a> <a id="1639" class="Symbol">→</a> <a id="1641" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="1643" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1645" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="1650" href="Data.List.Base.html#5034" class="Function Operator">L.[</a> <a id="1654" href="Bitcoin.Tx.Crypto.html#1611" class="Bound">k</a> <a id="1656" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1658" href="Data.List.Base.html#5034" class="Function Operator">L.[</a> <a id="1662" href="Bitcoin.Crypto.html#715" class="Postulate">SIG</a> <a id="1666" href="Bitcoin.Tx.Crypto.html#1611" class="Bound">k</a> <a id="1668" class="Symbol">(</a><a id="1669" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="1671" href="Bitcoin.Tx.Crypto.html#1615" class="Bound">t</a> <a id="1673" href="Bitcoin.Tx.Crypto.html#1628" class="Bound">j</a><a id="1674" class="Symbol">)</a> <a id="1676" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1678" href="Bitcoin.Tx.Crypto.html#1615" class="Bound">t</a> <a id="1680" href="Bitcoin.Tx.Crypto.html#1628" class="Bound">j</a>
<a id="1682" href="Bitcoin.Tx.Crypto.html#1597" class="Function">ver⋆sig≡</a> <a id="1691" class="Symbol">{</a><a id="1692" class="Argument">k</a> <a id="1694" class="Symbol">=</a> <a id="1696" href="Bitcoin.Tx.Crypto.html#1696" class="Bound">k</a><a id="1697" class="Symbol">}</a> <a id="1699" href="Bitcoin.Tx.Crypto.html#1699" class="Bound">t</a> <a id="1701" href="Bitcoin.Tx.Crypto.html#1701" class="Bound">j</a> <a id="1703" class="Keyword">rewrite</a> <a id="1711" href="Prelude.General.html#5371" class="Function">if-eta</a> <a id="1718" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1720" href="Bitcoin.Tx.Crypto.html#1111" class="Function">ver</a> <a id="1724" href="Bitcoin.Tx.Crypto.html#1696" class="Bound">k</a> <a id="1726" class="Symbol">(</a><a id="1727" href="Bitcoin.Crypto.html#715" class="Postulate">SIG</a> <a id="1731" href="Bitcoin.Tx.Crypto.html#1696" class="Bound">k</a> <a id="1733" class="Symbol">(</a><a id="1734" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="1736" href="Bitcoin.Tx.Crypto.html#1699" class="Bound">t</a> <a id="1738" href="Bitcoin.Tx.Crypto.html#1701" class="Bound">j</a><a id="1739" class="Symbol">))</a> <a id="1742" href="Bitcoin.Tx.Crypto.html#1699" class="Bound">t</a> <a id="1744" href="Bitcoin.Tx.Crypto.html#1701" class="Bound">j</a> <a id="1746" class="Symbol">=</a> <a id="1748" href="Bitcoin.Crypto.html#958" class="Function">VERSIG≡</a>

<a id="1757" class="Keyword">module</a> <a id="Example1"></a><a id="1764" href="Bitcoin.Tx.Crypto.html#1764" class="Module">Example1</a>
  <a id="1775" class="Symbol">(</a><a id="1776" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="1779" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="1782" href="Bitcoin.Tx.Crypto.html#1782" class="Bound">kᶜ</a> <a id="1785" class="Symbol">:</a> <a id="1787" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a><a id="1794" class="Symbol">)</a>
  <a id="1798" class="Symbol">(</a><a id="1799" href="Bitcoin.Tx.Crypto.html#1799" class="Bound">kᶜ≢kᵇ</a> <a id="1805" class="Symbol">:</a> <a id="1807" href="Bitcoin.Tx.Crypto.html#1782" class="Bound">kᶜ</a> <a id="1810" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1812" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a><a id="1814" class="Symbol">)</a> <a id="1816" class="Symbol">(</a><a id="1817" href="Bitcoin.Tx.Crypto.html#1817" class="Bound">kᶜ≢kᵃ</a> <a id="1823" class="Symbol">:</a> <a id="1825" href="Bitcoin.Tx.Crypto.html#1782" class="Bound">kᶜ</a> <a id="1828" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1830" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a><a id="1832" class="Symbol">)</a> <a id="1834" class="Symbol">(</a><a id="1835" href="Bitcoin.Tx.Crypto.html#1835" class="Bound">kᵇ≢kᵃ</a> <a id="1841" class="Symbol">:</a> <a id="1843" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="1846" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1848" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a><a id="1850" class="Symbol">)</a>
  <a id="1854" class="Symbol">(</a><a id="1855" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="1857" class="Symbol">:</a> <a id="1859" href="Bitcoin.Tx.Base.html#1114" class="Record">Tx</a> <a id="1862" class="Symbol">(</a><a id="1863" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1867" href="Bitcoin.Tx.Base.html#2199" class="Generalizable">i</a><a id="1868" class="Symbol">)</a> <a id="1870" href="Bitcoin.Tx.Base.html#2204" class="Generalizable">o</a><a id="1871" class="Symbol">)</a>
  <a id="1875" class="Keyword">where</a>
  <a id="Example1.σp"></a><a id="1883" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="1886" class="Symbol">=</a> <a id="1888" href="Bitcoin.Crypto.html#715" class="Postulate">SIG</a> <a id="1892" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="1895" class="Symbol">(</a><a id="1896" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="1898" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="1900" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="1902" class="Symbol">)</a>
  <a id="Example1.σq"></a><a id="1906" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="1909" class="Symbol">=</a> <a id="1911" href="Bitcoin.Crypto.html#715" class="Postulate">SIG</a> <a id="1915" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="1918" class="Symbol">(</a><a id="1919" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="1921" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="1923" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="1925" class="Symbol">)</a>

  <a id="1930" class="Keyword">open</a> <a id="1935" class="Keyword">import</a> <a id="1942" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>

  <a id="Example1.ks"></a><a id="1958" href="Bitcoin.Tx.Crypto.html#1958" class="Function">ks</a>  <a id="1962" class="Symbol">=</a> <a id="1964" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1969" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a> <a id="1977" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="1979" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="1981" href="Bitcoin.Tx.Crypto.html#1782" class="Bound">kᶜ</a> <a id="1984" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1986" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="1989" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1991" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="1994" href="Prelude.Nary.html#246" class="Function Operator">⟧</a>
  <a id="Example1.σs"></a><a id="1998" href="Bitcoin.Tx.Crypto.html#1998" class="Function">σs</a>  <a id="2002" class="Symbol">=</a> <a id="2004" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2009" href="Bitcoin.BasicTypes.html#244" class="Function">HashId</a>  <a id="2017" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="2019" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2021" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="2024" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2026" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2029" href="Prelude.Nary.html#246" class="Function Operator">⟧</a>
  <a id="Example1.σs′"></a><a id="2033" href="Bitcoin.Tx.Crypto.html#2033" class="Function">σs′</a> <a id="2037" class="Symbol">=</a> <a id="2039" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2044" href="Bitcoin.BasicTypes.html#244" class="Function">HashId</a>  <a id="2052" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="2054" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2056" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2059" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2061" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="2064" href="Prelude.Nary.html#246" class="Function Operator">⟧</a>

  <a id="2069" class="Comment">-- ** using equational reasoning</a>

  <a id="2105" class="Keyword">open</a> <a id="2110" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a>

  <a id="2125" href="Bitcoin.Tx.Crypto.html#2125" class="Function">_</a> <a id="2127" class="Symbol">:</a> <a id="2129" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2131" class="Symbol">(</a><a id="2132" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2137" href="Bitcoin.Tx.Crypto.html#1958" class="Function">ks</a> <a id="2140" href="Bitcoin.Tx.Crypto.html#1998" class="Function">σs</a> <a id="2143" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2145" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2147" class="Symbol">)</a>
  <a id="2151" class="Symbol">_</a> <a id="2153" class="Symbol">=</a> <a id="2155" href="Prelude.General.html#4125" class="Function">true⇒T</a>
    <a id="2166" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2168" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a>
        <a id="2182" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2187" href="Bitcoin.Tx.Crypto.html#1958" class="Function">ks</a> <a id="2190" href="Bitcoin.Tx.Crypto.html#1998" class="Function">σs</a> <a id="2193" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2195" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2204" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2216" class="Symbol">(</a><a id="2217" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2220" href="Bitcoin.Crypto.html#744" class="Postulate">VER</a> <a id="2224" href="Bitcoin.Tx.Crypto.html#1782" class="Bound">kᶜ</a> <a id="2227" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="2230" class="Symbol">(</a><a id="2231" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="2233" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2235" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2237" class="Symbol">)</a> <a id="2239" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
          <a id="2254" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2259" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2261" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="2264" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2266" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2269" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2271" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2273" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2276" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2278" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2280" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
        <a id="2291" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
          <a id="2306" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2311" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2313" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="2316" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2318" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2321" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2323" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2325" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="2328" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2330" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2333" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2335" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2337" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2339" class="Symbol">)</a>
      <a id="2347" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2350" href="Prelude.General.html#5283" class="Function">if-false</a> <a id="2359" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2361" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="2370" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2372" href="Bitcoin.Crypto.html#1020" class="Function">VERSIG≢</a> <a id="2380" href="Bitcoin.Tx.Crypto.html#1799" class="Bound">kᶜ≢kᵇ</a> <a id="2386" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="2396" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2401" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2403" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="2406" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2408" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2411" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2413" href="Bitcoin.Tx.Crypto.html#1998" class="Function">σs</a> <a id="2416" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2418" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2427" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2439" class="Symbol">(</a><a id="2440" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2443" href="Bitcoin.Crypto.html#744" class="Postulate">VER</a> <a id="2447" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="2450" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="2453" class="Symbol">(</a><a id="2454" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="2456" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2458" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2460" class="Symbol">)</a> <a id="2462" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
          <a id="2477" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2482" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2484" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2487" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2489" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2491" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2494" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2496" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2498" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
        <a id="2509" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
          <a id="2524" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2529" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2531" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2534" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2536" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2538" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="2541" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2543" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2546" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2548" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2550" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2552" class="Symbol">)</a>
      <a id="2560" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2563" href="Prelude.General.html#5198" class="Function">if-true</a> <a id="2571" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2573" href="Prelude.General.html#4167" class="Function">T⇒true</a> <a id="2580" href="Bitcoin.Crypto.html#958" class="Function">VERSIG≡</a> <a id="2588" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="2598" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2603" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2605" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2608" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2610" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2612" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2615" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2617" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2619" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2628" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2640" class="Symbol">(</a><a id="2641" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2644" href="Bitcoin.Crypto.html#744" class="Postulate">VER</a> <a id="2648" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2651" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2654" class="Symbol">(</a><a id="2655" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="2657" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2659" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2661" class="Symbol">)</a> <a id="2663" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
          <a id="2678" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2683" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2686" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2689" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2691" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
        <a id="2702" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
          <a id="2717" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2722" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2725" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2727" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2730" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2732" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2734" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2736" class="Symbol">)</a>
      <a id="2744" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2747" href="Prelude.General.html#5198" class="Function">if-true</a> <a id="2755" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2757" href="Prelude.General.html#4167" class="Function">T⇒true</a> <a id="2764" href="Bitcoin.Crypto.html#958" class="Function">VERSIG≡</a> <a id="2772" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="2782" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2787" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2790" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2793" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2795" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2804" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="2816" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
      <a id="2827" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>

  <a id="2832" href="Bitcoin.Tx.Crypto.html#2832" class="Function">_</a> <a id="2834" class="Symbol">:</a> <a id="2836" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="2838" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2840" class="Symbol">(</a><a id="2841" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2846" href="Bitcoin.Tx.Crypto.html#1958" class="Function">ks</a> <a id="2849" href="Bitcoin.Tx.Crypto.html#2033" class="Function">σs′</a> <a id="2853" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2855" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="2857" class="Symbol">)</a>
  <a id="2861" class="Symbol">_</a> <a id="2863" class="Symbol">=</a> <a id="2865" href="Prelude.General.html#4216" class="Function">false⇒¬T</a>
    <a id="2878" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2880" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a>
        <a id="2894" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2899" href="Bitcoin.Tx.Crypto.html#1958" class="Function">ks</a> <a id="2902" href="Bitcoin.Tx.Crypto.html#2033" class="Function">σs′</a> <a id="2906" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2908" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="2917" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="2920" href="Prelude.General.html#5283" class="Function">if-false</a> <a id="2929" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2931" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="2940" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2942" href="Bitcoin.Crypto.html#1020" class="Function">VERSIG≢</a> <a id="2950" href="Bitcoin.Tx.Crypto.html#1817" class="Bound">kᶜ≢kᵃ</a> <a id="2956" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="2966" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="2971" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2973" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a> <a id="2976" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2978" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="2981" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2983" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="2985" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="2988" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2990" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="2993" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="2995" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="2997" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="3006" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="3009" href="Prelude.General.html#5283" class="Function">if-false</a> <a id="3018" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3020" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3029" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3031" href="Bitcoin.Crypto.html#1020" class="Function">VERSIG≢</a> <a id="3039" href="Bitcoin.Tx.Crypto.html#1835" class="Bound">kᵇ≢kᵃ</a> <a id="3045" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="3055" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="3060" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="3062" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a> <a id="3065" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="3067" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="3069" href="Bitcoin.Tx.Crypto.html#1883" class="Function">σp</a> <a id="3072" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3074" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="3077" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="3079" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3081" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="3090" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="3093" href="Prelude.General.html#5198" class="Function">if-true</a> <a id="3101" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3103" href="Prelude.General.html#4167" class="Function">T⇒true</a> <a id="3110" href="Bitcoin.Crypto.html#958" class="Function">VERSIG≡</a> <a id="3118" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="3128" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="3133" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="3136" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="3138" href="Bitcoin.Tx.Crypto.html#1906" class="Function">σq</a> <a id="3141" href="Prelude.Nary.html#246" class="Function Operator">⟧</a> <a id="3143" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3145" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
      <a id="3154" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="3166" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
      <a id="3178" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>

  <a id="3183" class="Comment">-- ** using `rewrite`</a>

  <a id="3208" href="Bitcoin.Tx.Crypto.html#3208" class="Function">_</a> <a id="3210" class="Symbol">:</a> <a id="3212" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="3214" class="Symbol">(</a><a id="3215" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="3220" href="Bitcoin.Tx.Crypto.html#1958" class="Function">ks</a> <a id="3223" href="Bitcoin.Tx.Crypto.html#1998" class="Function">σs</a> <a id="3226" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3228" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3230" class="Symbol">)</a>
  <a id="3234" class="Symbol">_</a> <a id="3236" class="Keyword">rewrite</a> <a id="3244" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3253" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3255" href="Bitcoin.Crypto.html#1020" class="Function">VERSIG≢</a> <a id="3263" class="Symbol">{</a><a id="3264" class="Argument">x</a> <a id="3266" class="Symbol">=</a> <a id="3268" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="3270" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3272" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3274" class="Symbol">}</a> <a id="3276" href="Bitcoin.Tx.Crypto.html#1799" class="Bound">kᶜ≢kᵇ</a>
          <a id="3292" class="Symbol">|</a> <a id="3294" href="Prelude.General.html#4167" class="Function">T⇒true</a>   <a id="3303" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3305" href="Bitcoin.Crypto.html#958" class="Function">VERSIG≡</a> <a id="3313" class="Symbol">{</a><a id="3314" class="Argument">k</a> <a id="3316" class="Symbol">=</a> <a id="3318" href="Bitcoin.Tx.Crypto.html#1779" class="Bound">kᵇ</a><a id="3320" class="Symbol">}</a> <a id="3322" class="Symbol">{</a><a id="3323" class="Argument">x</a> <a id="3325" class="Symbol">=</a> <a id="3327" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="3329" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3331" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3333" class="Symbol">}</a>
          <a id="3345" class="Symbol">|</a> <a id="3347" href="Prelude.General.html#4167" class="Function">T⇒true</a>   <a id="3356" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3358" href="Bitcoin.Crypto.html#958" class="Function">VERSIG≡</a> <a id="3366" class="Symbol">{</a><a id="3367" class="Argument">k</a> <a id="3369" class="Symbol">=</a> <a id="3371" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a><a id="3373" class="Symbol">}</a> <a id="3375" class="Symbol">{</a><a id="3376" class="Argument">x</a> <a id="3378" class="Symbol">=</a> <a id="3380" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="3382" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3384" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3386" class="Symbol">}</a>
          <a id="3398" class="Symbol">=</a> <a id="3400" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a>

  <a id="3406" href="Bitcoin.Tx.Crypto.html#3406" class="Function">_</a> <a id="3408" class="Symbol">:</a> <a id="3410" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="3412" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="3414" class="Symbol">(</a><a id="3415" href="Bitcoin.Tx.Crypto.html#1377" class="Function">ver⋆</a> <a id="3420" href="Bitcoin.Tx.Crypto.html#1958" class="Function">ks</a> <a id="3423" href="Bitcoin.Tx.Crypto.html#2033" class="Function">σs′</a> <a id="3427" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3429" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3431" class="Symbol">)</a>
  <a id="3435" class="Symbol">_</a> <a id="3437" class="Keyword">rewrite</a> <a id="3445" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3454" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3456" href="Bitcoin.Crypto.html#1020" class="Function">VERSIG≢</a> <a id="3464" class="Symbol">{</a><a id="3465" class="Argument">x</a> <a id="3467" class="Symbol">=</a> <a id="3469" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="3471" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3473" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3475" class="Symbol">}</a> <a id="3477" href="Bitcoin.Tx.Crypto.html#1817" class="Bound">kᶜ≢kᵃ</a>
          <a id="3493" class="Symbol">|</a> <a id="3495" href="Prelude.General.html#4263" class="Function">¬T⇒false</a> <a id="3504" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3506" href="Bitcoin.Crypto.html#1020" class="Function">VERSIG≢</a> <a id="3514" class="Symbol">{</a><a id="3515" class="Argument">x</a> <a id="3517" class="Symbol">=</a> <a id="3519" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="3521" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3523" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3525" class="Symbol">}</a> <a id="3527" href="Bitcoin.Tx.Crypto.html#1835" class="Bound">kᵇ≢kᵃ</a>
          <a id="3543" class="Symbol">|</a> <a id="3545" href="Prelude.General.html#4167" class="Function">T⇒true</a>   <a id="3554" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3556" href="Bitcoin.Crypto.html#958" class="Function">VERSIG≡</a> <a id="3564" class="Symbol">{</a><a id="3565" class="Argument">k</a> <a id="3567" class="Symbol">=</a> <a id="3569" href="Bitcoin.Tx.Crypto.html#1776" class="Bound">kᵃ</a><a id="3571" class="Symbol">}</a> <a id="3573" class="Symbol">{</a><a id="3574" class="Argument">x</a> <a id="3576" class="Symbol">=</a> <a id="3578" href="Bitcoin.Tx.Crypto.html#869" class="Function">μ</a> <a id="3580" href="Bitcoin.Tx.Crypto.html#1855" class="Bound">t</a> <a id="3582" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="3584" class="Symbol">}</a>
          <a id="3596" class="Symbol">=</a> <a id="3598" href="Function.Base.html#624" class="Function">id</a>
</pre></body></html>