<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Bitcoin.Crypto</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Public-key cryptography.</a>
<a id="102" class="Comment">------------------------------------------------------------------------</a>
<a id="175" class="Keyword">module</a> <a id="182" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a> <a id="197" class="Keyword">where</a>

<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="229" class="Keyword">open</a> <a id="234" class="Keyword">import</a> <a id="241" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>

<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Bitcoin.BasicTypes.html" class="Module">Bitcoin.BasicTypes</a>

<a id="314" class="Keyword">record</a> <a id="KeyPair"></a><a id="321" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a> <a id="329" class="Symbol">:</a> <a id="331" class="PrimitiveType">Set</a> <a id="335" class="Keyword">where</a>
  <a id="343" class="Keyword">field</a>
    <a id="KeyPair.pub"></a><a id="353" href="Bitcoin.Crypto.html#353" class="Field">pub</a> <a id="357" class="Symbol">:</a> <a id="359" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
    <a id="KeyPair.sec"></a><a id="365" href="Bitcoin.Crypto.html#365" class="Field">sec</a> <a id="369" class="Symbol">:</a> <a id="371" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="373" class="Keyword">open</a> <a id="378" href="Bitcoin.Crypto.html#321" class="Module">KeyPair</a> <a id="386" class="Keyword">public</a>

<a id="394" class="Keyword">unquoteDecl</a> <a id="DecEqᵏᵖ"></a><a id="406" href="Bitcoin.Crypto.html#406" class="Function">DecEqᵏᵖ</a> <a id="414" class="Symbol">=</a> <a id="416" href="Prelude.Generics.html#5660" class="Function">DERIVE</a> <a id="423" href="Prelude.DecEq.html#487" class="Record">DecEq</a> <a id="429" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="431" class="Keyword">quote</a> <a id="437" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a> <a id="445" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="447" href="Bitcoin.Crypto.html#406" class="Function">DecEqᵏᵖ</a> <a id="455" href="Data.List.Base.html#4458" class="Function Operator">]</a>

<a id="458" class="Keyword">private</a>
  <a id="468" class="Keyword">variable</a>
    <a id="481" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="483" href="Bitcoin.Crypto.html#483" class="Generalizable">B</a> <a id="485" class="Symbol">:</a> <a id="487" class="PrimitiveType">Set</a>

<a id="492" class="Keyword">postulate</a>
  <a id="504" class="Comment">-- hashing function</a>
  <a id="HASH"></a><a id="526" href="Bitcoin.Crypto.html#526" class="Postulate">HASH</a> <a id="531" class="Symbol">:</a> <a id="533" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="535" class="Symbol">→</a> <a id="537" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>

  <a id="542" class="Comment">-- signing/verifying</a>
  <a id="SIG"></a><a id="565" href="Bitcoin.Crypto.html#565" class="Postulate">SIG</a> <a id="569" class="Symbol">:</a> <a id="571" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a> <a id="579" class="Symbol">→</a> <a id="581" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="583" class="Symbol">→</a> <a id="585" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
  <a id="VER"></a><a id="589" href="Bitcoin.Crypto.html#589" class="Postulate">VER</a> <a id="593" class="Symbol">:</a> <a id="595" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a> <a id="603" class="Symbol">→</a> <a id="605" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="607" class="Symbol">→</a> <a id="609" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="611" class="Symbol">→</a> <a id="613" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="VERSIG≡"></a><a id="620" href="Bitcoin.Crypto.html#620" class="Postulate">VERSIG≡</a> <a id="628" class="Symbol">:</a> <a id="630" class="Symbol">∀</a> <a id="632" class="Symbol">{</a><a id="633" href="Bitcoin.Crypto.html#633" class="Bound">k</a> <a id="635" class="Symbol">:</a> <a id="637" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a><a id="644" class="Symbol">}</a> <a id="646" class="Symbol">{</a><a id="647" href="Bitcoin.Crypto.html#647" class="Bound">x</a> <a id="649" class="Symbol">:</a> <a id="651" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a><a id="652" class="Symbol">}</a> <a id="654" class="Symbol">→</a> <a id="656" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="658" class="Symbol">(</a><a id="659" href="Bitcoin.Crypto.html#589" class="Postulate">VER</a> <a id="663" href="Bitcoin.Crypto.html#633" class="Bound">k</a> <a id="665" class="Symbol">(</a><a id="666" href="Bitcoin.Crypto.html#565" class="Postulate">SIG</a> <a id="670" href="Bitcoin.Crypto.html#633" class="Bound">k</a> <a id="672" href="Bitcoin.Crypto.html#647" class="Bound">x</a><a id="673" class="Symbol">)</a> <a id="675" href="Bitcoin.Crypto.html#647" class="Bound">x</a><a id="676" class="Symbol">)</a>

<a id="679" class="Comment">-- Concrete &quot;dummy&quot; hashing functions, for use in examples (so that they compute)</a>
<a id="761" class="Keyword">open</a> <a id="766" class="Keyword">import</a> <a id="773" href="Function.html" class="Module">Function</a> <a id="782" class="Keyword">using</a> <a id="788" class="Symbol">(</a><a id="789" href="Function.Base.html#992" class="Function Operator">_∘_</a><a id="792" class="Symbol">)</a>
<a id="794" class="Keyword">open</a> <a id="799" class="Keyword">import</a> <a id="806" href="Data.Product.html" class="Module">Data.Product</a> <a id="819" class="Keyword">using</a> <a id="825" class="Symbol">(</a><a id="826" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="829" class="Symbol">;</a> <a id="831" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="834" class="Symbol">)</a>
<a id="836" class="Keyword">open</a> <a id="841" class="Keyword">import</a> <a id="848" href="Data.List.html" class="Module">Data.List</a> <a id="858" class="Keyword">using</a> <a id="864" class="Symbol">(</a><a id="865" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="869" class="Symbol">;</a> <a id="871" href="Data.List.Base.html#4217" class="Function">sum</a><a id="874" class="Symbol">;</a> <a id="876" href="Data.List.Base.html#1497" class="Function">map</a><a id="879" class="Symbol">;</a> <a id="881" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="884" class="Symbol">;</a> <a id="886" href="Data.List.Base.html#9701" class="InductiveConstructor">[]</a><a id="888" class="Symbol">)</a>
<a id="890" class="Keyword">open</a> <a id="895" class="Keyword">import</a> <a id="902" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="911" class="Symbol">as</a> <a id="914" class="Module">V</a> <a id="916" class="Keyword">using</a> <a id="922" class="Symbol">(</a><a id="923" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="926" class="Symbol">)</a>
<a id="928" class="Keyword">open</a> <a id="933" class="Keyword">import</a> <a id="940" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="953" class="Keyword">using</a> <a id="959" class="Symbol">(</a><a id="960" href="Agda.Builtin.Int.html#264" class="InductiveConstructor">+_</a><a id="962" class="Symbol">;</a> <a id="964" href="Data.Integer.Base.html#2084" class="Function Operator">∣_∣</a><a id="967" class="Symbol">)</a>
<a id="969" class="Keyword">open</a> <a id="974" class="Keyword">import</a> <a id="981" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="990" class="Keyword">using</a> <a id="996" class="Symbol">(</a><a id="997" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="998" class="Symbol">)</a>
<a id="1000" class="Keyword">open</a> <a id="1005" class="Keyword">import</a> <a id="1012" href="Data.String.html" class="Module">Data.String</a> <a id="1024" class="Symbol">as</a> <a id="1027" class="Module">S</a> <a id="1029" class="Keyword">using</a> <a id="1035" class="Symbol">(</a><a id="1036" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="1042" class="Symbol">)</a>
<a id="1044" class="Keyword">open</a> <a id="1049" class="Keyword">import</a> <a id="1056" href="Data.Char.html" class="Module">Data.Char</a> <a id="1066" class="Keyword">using</a> <a id="1072" class="Symbol">(</a><a id="1073" href="Data.Char.Base.html#999" class="Primitive">toℕ</a><a id="1076" class="Symbol">)</a>

<a id="HashFunction"></a><a id="1079" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1092" class="Symbol">:</a> <a id="1094" class="PrimitiveType">Set</a> <a id="1098" class="Symbol">→</a> <a id="1100" class="PrimitiveType">Set</a>
<a id="1104" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1117" href="Bitcoin.Crypto.html#1117" class="Bound">A</a> <a id="1119" class="Symbol">=</a> <a id="1121" href="Bitcoin.Crypto.html#1117" class="Bound">A</a> <a id="1123" class="Symbol">→</a> <a id="1125" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>

<a id="merge♯"></a><a id="1128" href="Bitcoin.Crypto.html#1128" class="Function">merge♯</a> <a id="1135" class="Symbol">:</a> <a id="1137" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1142" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="1144" class="Symbol">→</a> <a id="1146" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="1148" href="Bitcoin.Crypto.html#1128" class="Function">merge♯</a> <a id="1155" class="Symbol">=</a> <a id="1157" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+_</a> <a id="1160" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1162" href="Data.List.Base.html#4217" class="Function">sum</a> <a id="1166" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1168" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1172" href="Data.Integer.Base.html#2084" class="Function Operator">∣_∣</a>

<a id="nat♯"></a><a id="1177" href="Bitcoin.Crypto.html#1177" class="Function">nat♯</a> <a id="1182" class="Symbol">:</a> <a id="1184" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1197" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1199" href="Bitcoin.Crypto.html#1177" class="Function">nat♯</a> <a id="1204" class="Symbol">=</a> <a id="1206" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+_</a>

<a id="list♯"></a><a id="1210" href="Bitcoin.Crypto.html#1210" class="Function">list♯</a> <a id="1216" class="Symbol">:</a> <a id="1218" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1231" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="1233" class="Symbol">→</a> <a id="1235" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1248" class="Symbol">(</a><a id="1249" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1254" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a><a id="1255" class="Symbol">)</a>
<a id="1257" href="Bitcoin.Crypto.html#1210" class="Function">list♯</a> <a id="1263" href="Bitcoin.Crypto.html#1263" class="Bound">h</a> <a id="1265" class="Symbol">=</a> <a id="1267" href="Bitcoin.Crypto.html#1128" class="Function">merge♯</a> <a id="1274" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1276" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1280" href="Bitcoin.Crypto.html#1263" class="Bound">h</a>

<a id="vec♯"></a><a id="1283" href="Bitcoin.Crypto.html#1283" class="Function">vec♯</a> <a id="1288" class="Symbol">:</a> <a id="1290" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1303" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="1305" class="Symbol">→</a> <a id="1307" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1320" class="Symbol">(</a><a id="1321" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1325" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="1327" href="Bitcoin.BasicTypes.html#302" class="Generalizable">n</a><a id="1328" class="Symbol">)</a>
<a id="1330" href="Bitcoin.Crypto.html#1283" class="Function">vec♯</a> <a id="1335" href="Bitcoin.Crypto.html#1335" class="Bound">h</a> <a id="1337" class="Symbol">=</a> <a id="1339" href="Bitcoin.Crypto.html#1210" class="Function">list♯</a> <a id="1345" href="Bitcoin.Crypto.html#1335" class="Bound">h</a> <a id="1347" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1349" href="Data.Vec.Base.html#7399" class="Function">V.toList</a>

<a id="pair♯"></a><a id="1359" href="Bitcoin.Crypto.html#1359" class="Function">pair♯</a> <a id="1365" class="Symbol">:</a> <a id="1367" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1380" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="1382" class="Symbol">→</a> <a id="1384" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1397" href="Bitcoin.Crypto.html#483" class="Generalizable">B</a> <a id="1399" class="Symbol">→</a> <a id="1401" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1414" class="Symbol">(</a><a id="1415" href="Bitcoin.Crypto.html#481" class="Generalizable">A</a> <a id="1417" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1419" href="Bitcoin.Crypto.html#483" class="Generalizable">B</a><a id="1420" class="Symbol">)</a>
<a id="1422" href="Bitcoin.Crypto.html#1359" class="Function">pair♯</a> <a id="1428" href="Bitcoin.Crypto.html#1428" class="Bound">h₁</a> <a id="1431" href="Bitcoin.Crypto.html#1431" class="Bound">h₂</a> <a id="1434" class="Symbol">(</a><a id="1435" href="Bitcoin.Crypto.html#1435" class="Bound">a</a> <a id="1437" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1439" href="Bitcoin.Crypto.html#1439" class="Bound">b</a><a id="1440" class="Symbol">)</a> <a id="1442" class="Symbol">=</a> <a id="1444" href="Bitcoin.Crypto.html#1128" class="Function">merge♯</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Bitcoin.Crypto.html#1428" class="Bound">h₁</a> <a id="1455" href="Bitcoin.Crypto.html#1435" class="Bound">a</a> <a id="1457" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1459" href="Bitcoin.Crypto.html#1431" class="Bound">h₂</a> <a id="1462" href="Bitcoin.Crypto.html#1439" class="Bound">b</a> <a id="1464" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1466" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1468" class="Symbol">)</a>

<a id="str♯"></a><a id="1471" href="Bitcoin.Crypto.html#1471" class="Function">str♯</a> <a id="1476" class="Symbol">:</a> <a id="1478" href="Bitcoin.Crypto.html#1079" class="Function">HashFunction</a> <a id="1491" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="1498" href="Bitcoin.Crypto.html#1471" class="Function">str♯</a> <a id="1503" class="Symbol">=</a> <a id="1505" href="Bitcoin.Crypto.html#1210" class="Function">list♯</a> <a id="1511" class="Symbol">(</a><a id="1512" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+_</a> <a id="1515" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1517" href="Data.Char.Base.html#999" class="Primitive">toℕ</a><a id="1520" class="Symbol">)</a> <a id="1522" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1524" href="Data.String.Base.html#1413" class="Primitive">S.toList</a>
</pre></body></html>