<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Bitcoin.Crypto</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Public-key cryptography.</a>
<a id="102" class="Comment">------------------------------------------------------------------------</a>
<a id="175" class="Keyword">module</a> <a id="182" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a> <a id="197" class="Keyword">where</a>

<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Data.Bool.html" class="Module">Data.Bool</a>    <a id="229" class="Keyword">using</a> <a id="235" class="Symbol">(</a><a id="236" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="240" class="Symbol">;</a> <a id="242" href="Data.Bool.Base.html#1451" class="Function">T</a><a id="243" class="Symbol">)</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="270" class="Keyword">using</a> <a id="276" class="Symbol">(</a><a id="277" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a><a id="278" class="Symbol">)</a>
<a id="280" class="Keyword">open</a> <a id="285" class="Keyword">import</a> <a id="292" href="Data.Product.html" class="Module">Data.Product</a> <a id="305" class="Keyword">using</a> <a id="311" class="Symbol">(</a><a id="312" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="315" class="Symbol">)</a>

<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>

<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Bitcoin.BasicTypes.html" class="Module">Bitcoin.BasicTypes</a>

<a id="403" class="Keyword">record</a> <a id="KeyPair"></a><a id="410" href="Bitcoin.Crypto.html#410" class="Record">KeyPair</a> <a id="418" class="Symbol">:</a> <a id="420" class="PrimitiveType">Set</a> <a id="424" class="Keyword">where</a>
  <a id="432" class="Keyword">field</a>
    <a id="KeyPair.pub"></a><a id="442" href="Bitcoin.Crypto.html#442" class="Field">pub</a> <a id="446" class="Symbol">:</a> <a id="448" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
    <a id="KeyPair.sec"></a><a id="454" href="Bitcoin.Crypto.html#454" class="Field">sec</a> <a id="458" class="Symbol">:</a> <a id="460" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="462" class="Keyword">open</a> <a id="467" href="Bitcoin.Crypto.html#410" class="Module">KeyPair</a> <a id="475" class="Keyword">public</a>

<a id="483" class="Keyword">unquoteDecl</a> <a id="DecEqᵏᵖ"></a><a id="495" href="Bitcoin.Crypto.html#495" class="Function">DecEqᵏᵖ</a> <a id="503" class="Symbol">=</a> <a id="505" href="Prelude.Generics.html#5792" class="Function">DERIVE</a> <a id="512" href="Prelude.DecEq.html#1787" class="Record">DecEq</a> <a id="518" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="520" class="Keyword">quote</a> <a id="526" href="Bitcoin.Crypto.html#410" class="Record">KeyPair</a> <a id="534" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="536" href="Bitcoin.Crypto.html#495" class="Function">DecEqᵏᵖ</a> <a id="544" href="Data.List.Base.html#4458" class="Function Operator">]</a>

<a id="547" class="Keyword">postulate</a>
  <a id="559" class="Comment">-- hashing function</a>
  <a id="HASH"></a><a id="581" href="Bitcoin.Crypto.html#581" class="Postulate">HASH</a> <a id="586" class="Symbol">:</a> <a id="588" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="590" class="Symbol">→</a> <a id="592" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>

  <a id="597" class="Comment">-- signing/verifying</a>
  <a id="SIG"></a><a id="620" href="Bitcoin.Crypto.html#620" class="Postulate">SIG</a> <a id="624" class="Symbol">:</a> <a id="626" href="Bitcoin.Crypto.html#410" class="Record">KeyPair</a> <a id="634" class="Symbol">→</a> <a id="636" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="638" class="Symbol">→</a> <a id="640" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
  <a id="VER"></a><a id="644" href="Bitcoin.Crypto.html#644" class="Postulate">VER</a> <a id="648" class="Symbol">:</a> <a id="650" href="Bitcoin.Crypto.html#410" class="Record">KeyPair</a> <a id="658" class="Symbol">→</a> <a id="660" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="662" class="Symbol">→</a> <a id="664" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="666" class="Symbol">→</a> <a id="668" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="VERSIG≡"></a><a id="675" href="Bitcoin.Crypto.html#675" class="Postulate">VERSIG≡</a> <a id="683" class="Symbol">:</a> <a id="685" class="Symbol">∀</a> <a id="687" class="Symbol">{</a><a id="688" href="Bitcoin.Crypto.html#688" class="Bound">k</a> <a id="690" class="Symbol">:</a> <a id="692" href="Bitcoin.Crypto.html#410" class="Record">KeyPair</a><a id="699" class="Symbol">}</a> <a id="701" class="Symbol">{</a><a id="702" href="Bitcoin.Crypto.html#702" class="Bound">x</a> <a id="704" class="Symbol">:</a> <a id="706" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a><a id="707" class="Symbol">}</a> <a id="709" class="Symbol">→</a> <a id="711" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="713" class="Symbol">(</a><a id="714" href="Bitcoin.Crypto.html#644" class="Postulate">VER</a> <a id="718" href="Bitcoin.Crypto.html#688" class="Bound">k</a> <a id="720" class="Symbol">(</a><a id="721" href="Bitcoin.Crypto.html#620" class="Postulate">SIG</a> <a id="725" href="Bitcoin.Crypto.html#688" class="Bound">k</a> <a id="727" href="Bitcoin.Crypto.html#702" class="Bound">x</a><a id="728" class="Symbol">)</a> <a id="730" href="Bitcoin.Crypto.html#702" class="Bound">x</a><a id="731" class="Symbol">)</a>

<a id="734" class="Comment">-- Concrete &quot;dummy&quot; hashing functions, for use in examples (so that they compute)</a>
<a id="816" class="Keyword">open</a> <a id="821" class="Keyword">import</a> <a id="828" href="Function.html" class="Module">Function</a> <a id="837" class="Keyword">using</a> <a id="843" class="Symbol">(</a><a id="844" href="Function.Base.html#992" class="Function Operator">_∘_</a><a id="847" class="Symbol">)</a>
<a id="849" class="Keyword">open</a> <a id="854" class="Keyword">import</a> <a id="861" href="Data.Product.html" class="Module">Data.Product</a> <a id="874" class="Keyword">using</a> <a id="880" class="Symbol">(</a><a id="881" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="884" class="Symbol">;</a> <a id="886" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="889" class="Symbol">)</a>
<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Data.List.html" class="Module">Data.List</a> <a id="913" class="Keyword">using</a> <a id="919" class="Symbol">(</a><a id="920" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="924" class="Symbol">;</a> <a id="926" href="Data.List.Base.html#4217" class="Function">sum</a><a id="929" class="Symbol">;</a> <a id="931" href="Data.List.Base.html#1497" class="Function">map</a><a id="934" class="Symbol">;</a> <a id="936" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="939" class="Symbol">;</a> <a id="941" href="Data.List.Base.html#9701" class="InductiveConstructor">[]</a><a id="943" class="Symbol">)</a>
<a id="945" class="Keyword">open</a> <a id="950" class="Keyword">import</a> <a id="957" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="966" class="Symbol">as</a> <a id="969" class="Module">V</a> <a id="971" class="Keyword">using</a> <a id="977" class="Symbol">(</a><a id="978" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="981" class="Symbol">)</a>
<a id="983" class="Keyword">open</a> <a id="988" class="Keyword">import</a> <a id="995" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="1008" class="Keyword">using</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Agda.Builtin.Int.html#264" class="InductiveConstructor">+_</a><a id="1017" class="Symbol">;</a> <a id="1019" href="Data.Integer.Base.html#2084" class="Function Operator">∣_∣</a><a id="1022" class="Symbol">)</a>
<a id="1024" class="Keyword">open</a> <a id="1029" class="Keyword">import</a> <a id="1036" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1045" class="Keyword">using</a> <a id="1051" class="Symbol">(</a><a id="1052" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1053" class="Symbol">)</a>
<a id="1055" class="Keyword">open</a> <a id="1060" class="Keyword">import</a> <a id="1067" href="Data.String.html" class="Module">Data.String</a> <a id="1079" class="Symbol">as</a> <a id="1082" class="Module">S</a> <a id="1084" class="Keyword">using</a> <a id="1090" class="Symbol">(</a><a id="1091" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="1097" class="Symbol">)</a>
<a id="1099" class="Keyword">open</a> <a id="1104" class="Keyword">import</a> <a id="1111" href="Data.Char.html" class="Module">Data.Char</a> <a id="1121" class="Keyword">using</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Data.Char.Base.html#999" class="Primitive">toℕ</a><a id="1131" class="Symbol">)</a>

<a id="HashFunction"></a><a id="1134" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1147" class="Symbol">:</a> <a id="1149" class="PrimitiveType">Set</a> <a id="1153" class="Symbol">→</a> <a id="1155" class="PrimitiveType">Set</a>
<a id="1159" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1172" href="Bitcoin.Crypto.html#1172" class="Bound">A</a> <a id="1174" class="Symbol">=</a> <a id="1176" href="Bitcoin.Crypto.html#1172" class="Bound">A</a> <a id="1178" class="Symbol">→</a> <a id="1180" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>

<a id="merge♯"></a><a id="1183" href="Bitcoin.Crypto.html#1183" class="Function">merge♯</a> <a id="1190" class="Symbol">:</a> <a id="1192" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1197" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="1199" class="Symbol">→</a> <a id="1201" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="1203" href="Bitcoin.Crypto.html#1183" class="Function">merge♯</a> <a id="1210" class="Symbol">=</a> <a id="1212" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+_</a> <a id="1215" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1217" href="Data.List.Base.html#4217" class="Function">sum</a> <a id="1221" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1223" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1227" href="Data.Integer.Base.html#2084" class="Function Operator">∣_∣</a>

<a id="nat♯"></a><a id="1232" href="Bitcoin.Crypto.html#1232" class="Function">nat♯</a> <a id="1237" class="Symbol">:</a> <a id="1239" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1252" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1254" href="Bitcoin.Crypto.html#1232" class="Function">nat♯</a> <a id="1259" class="Symbol">=</a> <a id="1261" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+_</a>

<a id="list♯"></a><a id="1265" href="Bitcoin.Crypto.html#1265" class="Function">list♯</a> <a id="1271" class="Symbol">:</a> <a id="1273" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1286" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="1288" class="Symbol">→</a> <a id="1290" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1303" class="Symbol">(</a><a id="1304" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1309" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a><a id="1310" class="Symbol">)</a>
<a id="1312" href="Bitcoin.Crypto.html#1265" class="Function">list♯</a> <a id="1318" href="Bitcoin.Crypto.html#1318" class="Bound">h</a> <a id="1320" class="Symbol">=</a> <a id="1322" href="Bitcoin.Crypto.html#1183" class="Function">merge♯</a> <a id="1329" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1331" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1335" href="Bitcoin.Crypto.html#1318" class="Bound">h</a>

<a id="vec♯"></a><a id="1338" href="Bitcoin.Crypto.html#1338" class="Function">vec♯</a> <a id="1343" class="Symbol">:</a> <a id="1345" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1358" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="1360" class="Symbol">→</a> <a id="1362" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1375" class="Symbol">(</a><a id="1376" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1380" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="1382" href="Bitcoin.BasicTypes.html#380" class="Generalizable">n</a><a id="1383" class="Symbol">)</a>
<a id="1385" href="Bitcoin.Crypto.html#1338" class="Function">vec♯</a> <a id="1390" href="Bitcoin.Crypto.html#1390" class="Bound">h</a> <a id="1392" class="Symbol">=</a> <a id="1394" href="Bitcoin.Crypto.html#1265" class="Function">list♯</a> <a id="1400" href="Bitcoin.Crypto.html#1390" class="Bound">h</a> <a id="1402" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1404" href="Data.Vec.Base.html#7399" class="Function">V.toList</a>

<a id="pair♯"></a><a id="1414" href="Bitcoin.Crypto.html#1414" class="Function">pair♯</a> <a id="1420" class="Symbol">:</a> <a id="1422" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1435" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="1437" class="Symbol">→</a> <a id="1439" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1452" href="Bitcoin.BasicTypes.html#368" class="Generalizable">B</a> <a id="1454" class="Symbol">→</a> <a id="1456" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1469" class="Symbol">(</a><a id="1470" href="Bitcoin.BasicTypes.html#366" class="Generalizable">A</a> <a id="1472" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1474" href="Bitcoin.BasicTypes.html#368" class="Generalizable">B</a><a id="1475" class="Symbol">)</a>
<a id="1477" href="Bitcoin.Crypto.html#1414" class="Function">pair♯</a> <a id="1483" href="Bitcoin.Crypto.html#1483" class="Bound">h₁</a> <a id="1486" href="Bitcoin.Crypto.html#1486" class="Bound">h₂</a> <a id="1489" class="Symbol">(</a><a id="1490" href="Bitcoin.Crypto.html#1490" class="Bound">a</a> <a id="1492" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1494" href="Bitcoin.Crypto.html#1494" class="Bound">b</a><a id="1495" class="Symbol">)</a> <a id="1497" class="Symbol">=</a> <a id="1499" href="Bitcoin.Crypto.html#1183" class="Function">merge♯</a> <a id="1506" class="Symbol">(</a><a id="1507" href="Bitcoin.Crypto.html#1483" class="Bound">h₁</a> <a id="1510" href="Bitcoin.Crypto.html#1490" class="Bound">a</a> <a id="1512" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1514" href="Bitcoin.Crypto.html#1486" class="Bound">h₂</a> <a id="1517" href="Bitcoin.Crypto.html#1494" class="Bound">b</a> <a id="1519" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1521" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1523" class="Symbol">)</a>

<a id="str♯"></a><a id="1526" href="Bitcoin.Crypto.html#1526" class="Function">str♯</a> <a id="1531" class="Symbol">:</a> <a id="1533" href="Bitcoin.Crypto.html#1134" class="Function">HashFunction</a> <a id="1546" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="1553" href="Bitcoin.Crypto.html#1526" class="Function">str♯</a> <a id="1558" class="Symbol">=</a> <a id="1560" href="Bitcoin.Crypto.html#1265" class="Function">list♯</a> <a id="1566" class="Symbol">(</a><a id="1567" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+_</a> <a id="1570" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1572" href="Data.Char.Base.html#999" class="Primitive">toℕ</a><a id="1575" class="Symbol">)</a> <a id="1577" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1579" href="Data.String.Base.html#1413" class="Primitive">S.toList</a>
</pre></body></html>